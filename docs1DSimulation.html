<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>SimVascular Docs</title>

    <link href="css/bootstrap.css" rel="stylesheet" type="text/css" />

    <link href="css/shop-item.css" rel="stylesheet" type="text/css" />

    <link href="css/codestyle.css" rel="stylesheet" type="text/css" />

    <link rel="stylesheet" href="font-awesome-4.1.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/1.5.2/css/ionicons.min.css">

    <link rel="shortcut icon" href="img/favicon.ico">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
                <i class="fa fa-bars" id="barIcon"></i>
              </button>
                <a class="navbar-brand" id="brandName" href="index.html">
                  <img src="img/svlogo/svLogoSmallText.png" alt="...">
                </a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-right navbar-main-collapse">
                <ul class="nav navbar-nav">

                  <!-- USER GUIDES -->
                  <li>
                    <a href="#" id="dropdownMenu1" data-toggle="dropdown">
                      <b><span class="fa fa-user"></span> User Guides</b>
                    </a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="docsInstallation.html"><b><span class="fa fa-sign-in fa-rotate-90"></span> Installation</b></a></li>
                      <li role="presentation" class="divider"></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="docsQuickGuide.html"><b><span class="icon ion-ios7-bolt"></span> Quick Guide</b></a></li>
                      <li role="presentation" class="divider"></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="docsModelGuide.html"><b><span class="icon ion-settings"></span> Modeling</b></a></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="docsMeshing.html"><b><span class="icon ion-ios7-keypad"></span> Meshing</b></a></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="docsFlowSolver.html"><b><span class="icon ion-play"></span> Simulation</b></a></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="docssvFSI.html"><b><span class="icon ion-plus-round"></span> svFSI</b></a></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="docs1DSimulation.html"><b><span class="icon ion-plus-round"></span> 1D Simulation</b></a></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="docsGenBC.html"><b><span class="icon ion-refresh"></span> GenBC</b></a></li>
                    </ul>
                  </li>

                  <!-- CLINCAL CASES -->
                  <li>
                    <a href="#" id="dropdownMenu1" data-toggle="dropdown">
                      <b><i class="fa fa-stethoscope"></i> Clinical Cases</b>
                    </a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="clinicalCase3.html"><b><span class="fa fa-user-md"></span> Coronary Normal</b></a></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="clinicalCase1.html"><b><span class="fa fa-user-md"></span> Aortofemoral Normal - 1</b></a></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="clinicalCase2.html"><b><span class="fa fa-user-md"></span> Aortofemoral Normal - 2</b></a></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="clinicalCase4.html"><b><span class="fa fa-user-md"></span> Healthy Pulmonary</b></a></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://simtk.org/projects/sv_tests"><b><span class="fa fa-user-md"></span> All demo projects</b></a></li>
                    </ul>
                  </li>

                  <!-- DEVELOPER GUIDES -->
                  <li>
                    <a href="#" id="dropdownMenu1" data-toggle="dropdown">
                      <b><span class="fa fa-caret-square-o-right"></span> Developer Guides</b>
                    </a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="docsCompile.html"><b><span class="fa fa-file-text-o"></span> Compile Source Code</b></a></li>
                    </ul>
                  </li>

                  <!-- svCOMMUNITY -->
                  <li>
                    <a href="#" id="dropdownMenu1" data-toggle="dropdown">
                      <b><i class="fa fa-users"></i> svCommunity</b>
                    </a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://simtk.org/forums/viewforum.php?f=188"><b><span class="fa fa-users"></span> Public Forum</b></a></li>
                      <li role="presentation" class="divider"></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://simtk.org/mailman/listinfo/simvascular-news"><b><span class="fa fa-sign-in"></span> Join News Mailing List</b></a></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://simtk.org/pipermail/simvascular-news/"><b><span class="fa fa-pencil-square-o"></span> News Mailing List Archive</b></a></li>
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://github.com/SimVascular/SimVascular/issues"><b><span class="fa fa-bug"></span> Report bugs and request features</b></a></li>
                    </ul>
                  </li>

                  <!-- REFERENCES -->
                  <li>
                    <a href="docsRefs.html" id="dropdownMenu1" >
                      <b><span class="icon ion-document-text"></span>References</b>
                    </a>
                  </li>

                  <!-- Archives -->
                  <li>
                    <a href="#" id="dropdownMenu1" data-toggle="dropdown">
                      <b> Archives</b>
                    </a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                      <li role="presentation"><a role="menuitem" tabindex="-1" href="archiveQuickGuideSV2.html"><b>SimVascular 2.0</b></a></li>
                    </ul>
                  </li>

                    <!-- <li><a href="docsQuickGuide.html" id="btnQuickGuide"><b><span class="icon ion-ios7-bolt"></span> Quick Guide</b></a></li>
                    <li><a href="docsModelGuide.html" id="btnModelGuide"><b><span class="icon ion-settings"></span> Modeling</b></a></li>

                    <li><a href="docsMeshing.html" id="btnMeshing"><b><span class="icon ion-ios7-keypad"></span> Meshing</b></a></li>
                    <li><a href="docsPresolver.html" id="btnPresolver"><b><span class="icon ion-log-in"></span> svPre</b></a></li>
                    <li><a href="docsFlowSolver.html" id="btnFlowSolver"><b><span class="icon ion-play"></span> svSolver</b></a></li>
                    <li><a href="docsRefs.html" id="btnRefs"><b><span class="icon ion-document-text"></span> References</b></a></li>
                    <li><a href="clinicalCase1.html" id="btnRefs"><b>Case Studies</b></a></li> -->
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Content -->
    <!--Nav Bar -->
<div class="row">
    <div class="col-xs-1 col-sm-1 hidden-md hidden-lg">
    </div>
    <!-- ONE COLUMN OF SPACE -->
    <nav class="hidden-xs hidden-sm col-md-2 col-lg-2 bs-docs-sidebar">







        <ul id="sidebar" class="nav nav-stacked fixed man1DSimulation"> <p><h3>1D Simulation Guide</h3></p>
<li><a href="#intro">Introduction</a></li>
<li><a href="#tool">1D Simulation Tool</a>
  <ul class="nav nav-stacked">
    <li><a href="#mesh-panel">1D Mesh Panel</a></li>
    <li><a href="#basic-panel">Basic Parameters Panel</a></li>
    <li><a href="#bcs-panel">Inlet and Outlet BCs Panel</a></li>
    <li><a href="#wall-props-panel">Wall Properties Panel</a></li>
    <li><a href="#solver-params-panel">Solver Parameters Panel</a></li>
    <li><a href="#create-files-panel">Create Files and Run Simulation Panel</a></li>
    <li><a href="#convert-results-panel">Convert Results Panel</a></li>
    <li><a href="#tool-tutorial">Tutorial</a></li>
    <li><a href="#tool-refs">References</a></li>
  </ul>
</li>

<li><a href="#solver">1D Solver</a>
  <ul class="nav nav-stacked">
        <li><a href="#solver-theory">Theory</a></li>
        <li><a href="#solver-user-guide">User Guide</a></li>
        <li><a href="#solver-input-file">Input File Format</a></li>
        <li><a href="#solver-tutorial-simple-artery">Tutorial - Simple Artery </a></li>
        <li><a href="#solver-tutorial-aorta-iliac">Tutorial - Aorta and Iliac Arteries</a></li>
        <li><a href="#solver-tutorial-aorta-femoral">Tutorial - Aorta and Femoral Arteries</a></li>
        <li><a href="#solver-refs">References</a></li>
  </ul>
</li>

<h3>Download</h3>
</ul>





    </nav>

    <!--Main Content -->
    <div class="col-xs-10 col-sm-10 col-md-9 col-lg-9" id="manualContent">

      <!-- ACTUAL CONTENT -->







        <div class="man1DSimulation"><section id="intro" class="group"><h1>Introduction</h1>

<p>The SimVascular <strong>1D Simulation Tool</strong> is used to interactively create the geometry, boundary conditions and solver 
parameters needed to execute a <strong>sv1DSolver</strong> simulation. The <strong>sv1DSolver</strong> solves for blood pressure and flow 
in deformable one-dimensional hemodynamic networks. These equations offer a relatively efficient means to reproduce 
realistic wave propagation phenomemon in vascular networks. One-dimensional networks can be coupled to both 0D lumped 
parameter models and to more complex 3D flow simulations as boundary conditions.</p>

<h3>Centerlines Geometry</h3>

<p>The geometry of the one-dimensional networks used for a 1D simulation is based on the centerlines computed from the surface 
of a 3D geometric model.  The 3D geometric model is created from image data using the typical 
SimVascular <a href="docsModelGuide.html"> modeling workflow </a>.</p>

<p>Centerlines represent a 1D characterization of blood vessel geometry. The centerlines are computed for a 3D surface using 
the <a href="http://www.vmtk.org/tutorials/Centerlines.html"> Vascular Modeling Toolkit </a>. The computation solves a wave propagation
problem using a source point representing the start of the centerlines and target points representing the ends of the centerlines.
The source and target points are selected from the model caps defined in the SimVascular <strong>Modeling Tool</strong>.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/images/model-geom.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <img src="documentation/1d_simulation/images/centerlines.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
  <figcaption> <i>The centerlines (right) computed from a 3D geometric model of the aorta and femoral arteries (left). </i></figcaption>
</figure>
<br></p>

<h3>Network Geometry and 1D Simulation Mesh</h3>

<p>The centerlines geometry is used to define network <strong>nodes</strong> at vessel inlets, outlets and branching points. A number of cylindrical 
<strong>segments</strong> are defined representing the length and diameter between vessel <strong>nodes</strong>.</p>

<p><br>
<figure>
  <img class="svImg svImgSm" src="documentation/1d_simulation/images/vessel-segments.png">
  <figcaption class="svCaption"> The cylindrical segments representing vessel length and diameter between branching points. </figcaption>
</figure>
<br></p>

<p>Segments are then discretized into a mesh of finite elements in order to numerically solve the 1D equations of fluid flow in 
deformable vessels.</p>

<p><br>
<figure>
  <img class="svImg svImgMd" src="documentation/1d_simulation/images/segment-elements.png">
  <figcaption class="svCaption"> A segment is discretized into a mesh of finite elements. </figcaption>
</figure>
<br></p>

<h3>Units</h3>

<p>All model quantities and associated boundary conditions are specified in CGS units.</p>
</section>

<section id="tool" class="group"><h1>1D Simulation Tool</h1>

<p>The SimVascular <strong>1D Simulation Tool</strong> is used to interactively create an input file defining the geometry, boundary conditions,
material properties and solver parameters needed to execute a 1D solver simulation. A <strong>1D Simulation Tool</strong> instance is created by 
right-clicking on the <strong>Simulations1d</strong> node under the <strong>SV Data Manager</strong>. Selecting the <strong>Create 1D Simulation job</strong> menu item displays
a popup window.</p>

<p><br>
<figure>
  <img class="svImg svImgSm" src="documentation/1d_simulation/tool/images/create-job.png">
  <figcaption class="svCaption"> The <b>Create 1D Simulation Job</b> popup menu. </figcaption>
</figure></p>

<p>Use the <strong>Select Model</strong> list to select the 3D geometric surface model used to create centerlines. The list contains the names of 
all models created by any SimVascular <strong>Modeling Tool</strong> instance. Type in a job name used to identify the <strong>Simulations1d Tool</strong> instance 
and to name the files and directories stored under the SimVascular project&rsquo;s <strong>Simulations1d</strong> directory. Selecting <strong>OK</strong> creates 
an <strong>Simulations1d Tool</strong> instance node under the <strong>SV Data Manager</strong>. Selecting this instance displays the <strong>Simulations1d Tool</strong>
panel.</p>

<p><br>
<figure>
<img src="documentation/1d_simulation/tool/images/panel.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
  <figcaption class="svCaption"> The 1D Simulation Tool panel. </figcaption>
</figure>
<br></p>

<p>The panel contains seven sub-panels used to create or input a specific category of data needed to execute a 1D solver simulation.
<ul style="list-style-type:none;">
  <li> 1D Mesh </li>
  <li> Basic Parameters </li>
  <li> Inlet and Outlet BCs </li>
  <li> Wall Properties </li>
  <li> Solver Parameters </li>
  <li> Create Files and Run Simulation </li>
  <li> Convert Results </li>
</ul></p>

<p>A selecting a sub-panel name brings up the sub-panel&rsquo;s widgets. The following sections describe how each of the sub-panels are used.</p>
</section>
  <section id="mesh-panel" class="subgroup"><h2>1D Mesh Panel</h2>

<p>The 1D Mesh panel is primarily used to create centerlines from the surface of a 3D geometric model. A source for the centerline 
computation must first be selected from the inlet/outlet faces (model caps) defined by the <strong>Modeling Tool</strong>. The number of
elements used to discretize a segment may be controled by setting the element size.</p>

<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #e6e600; border-left: 6px solid #e6e600">
The centerline computation may take a significant amount of time to finish for a large model with many vessel branches. It is
also sensitive to the quality of the model surface mesh. If the surface mesh is not well-defined (e.g. has holes or overlapping faces)
then the centerline computation may fail. 
</div>

<p><br></p>

<h3>Panel Layout</h3>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/panel.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<h3>Usage</h3>

<p><strong>Model</strong> - The name of the model used to create centerlines. The model is selected when creating the simulation job. This text box is for display only, a model name cannot be entered.</p>

<p><strong>Select Inlet Face</strong> - Select the source for the centerline computation. Clicking on this button causes a multi-element 
check box to appear with entries for each model inlet/outlet face. A (single) face is selected, typically vessel inlet.</p>

<p><img class="svImg svImgSm" src="documentation/1d_simulation/tool/images/source-face.png"></p>

<p><strong>Inlet Face</strong> - The model face name used as a source for the centerline computation. This text box is for display only,
                 a face name cannot be entered.</p>

<p><strong>Calculate Centerlines</strong> - Start the centerline computation. </p>

<p><strong>Element size</strong> - Set the size of elements used to discretize a segment. </p>
</section>
  <section id="basic-panel" class="subgroup"><h2>Basic Parameters Panel</h2>

<p>The Basic Parameters panel is used to set the fluid physical parameters.</p>

<h3>Panel Layout</h3>

<p>The panel GUI contains a single table. </p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/basic-panel-fixed.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<h3>Usage</h3>

<p>Values may be entered in the table by double clicking in the <strong>Value</strong> column.</p>

<p><strong>Fluid Density</strong> - The value of the fluid density used for simulations. </p>

<p><strong>Fluid Viscosity</strong> - The value of the fluid Viscosity used for simulations. </p>
</section>
  <section id="bcs-panel" class="subgroup"><h2>Inlet and Outlet BCs Panel</h2>

<p>The Inlet and Outlet BCs panel is used to set the boundary condition type and parameter values for each inlet and outlet 
face defined for the model. The following types of boundary conditions are supported
<ol>
  <li>Prescribed velocites</li>
  <li>Resistance</li>
  <li>RCR</li>
</ol></p>

<h3>Panel Layout</h3>

<p>The panel GUI contains a single table listing the inlet and outlet faces defined for the model. The panel shown below has 
three inlet and outlet faces defined.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/bcs-panel-fixed.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<h3>Usage</h3>

<p>The boundary condition type and associated parameter values are changed by double clicking on a face name in the <strong>Name</strong> column. 
This displays a <strong>Set Inlet/Outlet BCs</strong> popup window. The parameters displayed in the window depend on the boundary condition
type</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/bcs-pres-vel.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <img src="documentation/1d_simulation/tool/images/bcs-res.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <img src="documentation/1d_simulation/tool/images/bcs-rcr.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
  <figcaption> <i><b>Set Inlet/Outlet BCs</b> popup window for different boundary condition types: Prescribed velocites, Resistance and RCR.</i></figcaption>
</figure>
<br></p>

<h4>Prescribed velocites</h4>

<p>The <strong>Prescribed velocites</strong> boundary condition defines a flow waveform for an inlet face. The inlet flow rates are provided by a text file
with time and flow value colums. </p>

<h5><u>Usage</u></h5>

<p>Analytic Shape - Defines the shape of the velocity profile: parabolid, plug or wormersley.
<br>
Point Number - Defines ?
<br>
Fourier Modes - Defines ?
<br>
Flow rate (from file) - Selecting the <strong>&hellip;</strong> brings a file browser used to selected a flow file. 
<br>
Period - 
<br>
Flip normal - 
<br>
<br></p>

<h4>Resistance</h4>

<p>The <strong>Resistance</strong> boundary condition defines the downstream resistance for an outlet face. </p>

<h5><u>Usage</u></h5>

<p>Resistance - The resistance parameter that characterizes the downstream vasculature.
<br>
Distal Pressure - Defines ?
<br>
<br></p>

<h4>RCR</h4>

<p>The <strong>RCR</strong> boundary condition defines the downstream resistance for an outlet face. </p>

<h5><u>Usage</u></h5>

<p>Rp C Rd - The resistance parameter that characterizes the downstream vasculature.
<br>
Distal Pressure - Defines ?</p>
</section>
  <section id="wall-props-panel" class="subgroup"><h2>Wall Properites Panel</h2>

<p>The Wall Properites panel is used to set the material properties for vessel walls. The following material models are supported
<ol>
  <li>Linear</li>
  <li>Olufsen</li>
</ol></p>

<h3>Panel Layout</h3>

<p>The panel GUI contains parameters that vary with the material model selected by the <strong>Material Model</strong> combination box.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/wall-props-linear-fixed.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <img src="documentation/1d_simulation/tool/images/wall-props-olufsen-fixed.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
  <figcaption> <i>The panel displays different material parameters depending on the material model selected.</i></figcaption>
</figure>
<br></p>

<h3>Usage</h3>

<p>The boundary condition type and associated parameter values are changed by double clicking on a face name in the <strong>Name</strong> column. 
This displays a <strong>Set Inlet/Outlet BCs</strong> popup window. The parameters displayed in the window depend on the boundary condition
type
<br></p>

<h4>Linear</h4>

<p>The <strong>Linear</strong> material model.</p>

<h5><u>Usage</u></h5>

<p>Eh/r - The product of elastic modulus and thickness divided by the radius.
<br>
Pressure - The material reference pressure.
<br>
<br></p>

<h4>Olufsen</h4>

<p>The <strong>Olufsen</strong> material model.</p>

<h5><u>Usage</u></h5>

<p>K1, K2, K3 - The empirically-derived constants used to best fit the equation $Eh/r_0(z) = k_1 \exp(k_2 r_0(z)) + k_3 $.
<br>
Exponent - The material exponent.
<br>
Pressure - The material reference pressure.
<br></p>
</section>
  <section id="solver-params-panel" class="subgroup"><h2>Solver Parameters Panel</h2>

<p>The Solver Parameters panel is used to set the parameters needed to execute the 1D Solver.</p>

<p>Simulation results are computed for times <strong>Time Step Size</strong>*i, i = 0,1,2,&hellip;,<strong>Number of Time Steps</strong> but are<br>
only written with the frequency given by <strong>Number of Timesteps between Saving Data</strong>.</p>

<h3>Panel Layout</h3>

<p>The panel GUI contains a single table listing <strong>Time Step</strong> and <strong>Output Control</strong> solver parameters.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/solver-params-panel-fixed.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<h3>Usage</h3>

<p>Values may be entered in the table by double clicking in the <strong>Value</strong> column.</p>

<p><strong>Number of Time Steps</strong> - The number of time steps to use for the 1D simulation.</p>

<p><strong>Time Step Size</strong> - The size of the time step to use for the 1D simulation. Time step size affects numerical error and stability.</p>

<p><strong>Number of Timesteps between Saving Data</strong> - The number of time steps to skip when saving 1D simulation results.</p>
</section>
  <section id="create-files-panel" class="subgroup"><h2>Create Files and Run Simulation Panel</h2>

<p>The Create Files and Run Simulation panel is used to create a 1D solver input file and run the 1D solver.</p>

<h3>Panel Layout</h3>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/create-files-panel-fixed.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<h3>Usage</h3>

<p><strong>Create Files for Simulation</strong> - Create a 1D solver input file. </p>

<p><strong>Run Simulation</strong> - Run the 1D solver. </p>
</section>
  <section id="convert-results-panel" class="subgroup"><h2>Convert Results</h2>

<p>The Convert Results panel is used to convert 1D simulation results to a CSV file format. </p>

<p>The simulation results directory must contain a 1D solver input file named <strong>solver.in</strong> and results (.dat) files. 
Simulation results are stored in the project&rsquo;s <strong>Simulations1d/JOBNAME</strong> directory.  </p>

<p>Results can be selectively converted for segements at vessel outlets. </p>

<p>A time range start/stop values can be given to only convert results within that range. The data conversion times 
are determined by the parameter values specified in the <strong>Solver Parameters</strong> panel.</p>

<p>The 1D solver writes results for cross-section area, flow, pressure, Reynolds number (Re), and wall shear stress (wss).
Results can be selectively converted for one or more of these data.</p>

<h3>Panel Layout</h3>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/convert-results-panel-fixed.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<h3>Usage</h3>

<p><strong>Results Directory</strong> - Set the directory containing the 1D simulation results to convert. The directory path can be entered in 
                        the text box. Selecting <strong>&hellip;</strong> brings up a file browser.</p>

<p><strong>Convert Directory</strong> - Set the directory where converted results are written. The directory path can be entered in 
                        the text box. Selecting <strong>&hellip;</strong> brings up a file browser.</p>

<p><strong>Start</strong> - Set the start time for the time range usded to convert simulation data. The time is a real simulation time value.</p>

<p><strong>Stop</strong> - Set the stop time for the time range usded to convert simulation data. The time is a real simulation time value.</p>

<p><strong>Segements</strong> - Set the segment type used to convert data. Select <b>Outlet</b> to convert data only for segments that have 
                an outlet boundary condition. Select <b>All</b> for converting data for all segments.</p>

<p><strong>Data</strong> - Set the names of data to convert. </p>

<p><strong>Convert</strong> - Convert the 1D simulation results.</p>
</section>
  <section id="tool-tutorial" class="subgroup"><h2> Tutorial </h2>

<p>This section demonstrates how to use the <strong>1D Simulation Tool</strong> to interactively create the geometry, 
boundary conditions and solver parameters needed to execute a <strong>sv1DSolver</strong> simulation. The geometry of 
the one-dimensional networks used for a 1D simulation is based on the model of the aorta and branching
left and right iliac vessels created in the Demo Project discussed in the SimVascular <a href="docsQuickGuide.html#simulation"> QuickGuide </a> documentation. </p>

<p>A flow rate inlet boundary condition is used for the aorta inlet. RCR boundary conditions are used for left and 
left and right iliac vessels. </p>

<p>An Olufsen material model is used for the vessel wall properties.</p>

<p><br>
<h3> Open the Demo Project </h3></p>

<p>Opening the Demo Project displays the image slices and model geometry. Change the display layout to big 3D 
and hide the image to get a better view of the model.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/open-demo-project.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <img src="documentation/1d_simulation/tool/images/tutorial-1/open-demo-project-model.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
  <figcaption> <i> (Left) The model of the aorta and branching left and right iliac vessels created in the Demo Project. (Right) Hiding the image and changing layout to big 3D. </i></figcaption>
</figure>
<br></p>

<h3> Create an instance of the 1D Simulation Tool </h3>

<p>Create an instance of the <strong>1D Simulation Tool</strong> by right clicking on the <strong>SV Data Manager</strong> <strong>Simulations1d</strong> node
and selecting <strong>Create 1D Simulation job</strong> from the popup menu.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/create-instance.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p>A box is then displayed that is used to select a model name and to enter the name of the 
1D simulation job to create. The <strong>Select Model</strong> is set to the default model name <strong>demo</strong>, 
the only model defined. Enter <strong>demo</strong> in the <strong>Job Name</strong> text box to create a 1D simulation 
job named <strong>demo</strong>. Click <strong>OK</strong>.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/create-instance-job.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p>A node named <strong>demo</strong> is created under <strong>SV Data Manager</strong> <strong>Simulations1d</strong>. Left clicking on this node
brings up the <strong>1D Simulation Tool</strong> GUI panel on the right side of the SimVascular window. The model name is 
displayed in the <strong>Model</strong> text box. The model surface representation is changed to wireframe to better show 
centerlines geometry when it is created.</p>

<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid green; border-left: 6px solid green">
Note that the <b>Calculate Centerlines</b> button is grayed out and disabled. This is because a source face 
has not yet been selected. The button is enabled after a source face is selected. Some of the widgets in other 
panels are similarly disabled until the data they depend on becomes available.
</div>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/create-instance-panel.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<!-- ------------------------------------ -->

<!--     Create centerlines geometry      -->

<!-- ------------------------------------ -->

<h3> Create centerlines geometry </h3>

<p>Select a model inlet face for the start of the centerlines by clicking on the <strong>Select Inlet Face</strong> button. 
This brings up a check box listing all of the caps (inlet/outlet faces) defined for the <strong>demo</strong> model.
Select the <b>cap_aorta</b> entry box under the <strong>Use</strong> column of the check box. </p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/create-cl-face.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p>The inlet face selected is displyed in the <strong>Inlet Face</strong> text box. Click on the <strong>Calculate Centerlines</strong> button to start the 
centerlines computation for the <strong>demo</strong> surface 3D geometric model. 
When the computation finishes the centerlines geometry is displyed using green lines.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/create-cl-lines.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<!-- -------------------------------------------- -->

<!-- Setting inlet and outlet boundary conditions -->

<!-- -------------------------------------------- -->

<h3> Set inlet and outlet boundary conditions </h3>

<p>Select the <strong>Inlet and Outlet BCs</strong> sub-panel name to bring up the <strong>Inlet and Outlet BCs</strong> panel used to set the boundary condition type 
and parameter values for each inlet and outlet face defined for the model.  </p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/bcs-panel.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p>The panel contains a table listing the inlet (cap_aorta) and two outlet (cap_right_iliac and cap_aorta_2) faces 
defined for the model.</p>

<p><br>
<h4><b> Set <i>cap_aorta</i> inlet flow boundary condition </b></h4>
Double click with the left mouse button on <b>cap_aorta</b> under the <strong>Name</strong> column. 
This brings up a <strong>Set Inlet/Outlet BCs</strong> popup window. To set an inlet flow boundary condition 
<div style="background-color: #F0F0F0; padding: 10px">
1) From the <b>BC Type</b> list select <strong>Prescribed Velocities</strong> <br>
2) Left click on the <strong>Flow rate (from file)</strong> <strong>&hellip;</strong> button to bring up a file browser    <br>
3) Select the inflow.flow file from the project&rsquo;s <strong>flow-files</strong> directory <br>
4) Select <strong>OK</strong><br>
</div>
<br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/bcs-aorta.png" style="float: left; width: 20%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p><br>
<h4><b> Set <i>cap_right_iliac</i> RCR boundary condition </b></h4>
Double click with the left mouse button on <b>cap<em>right</em>iliac</b> under the <strong>Name</strong> column. 
This brings up a <strong>Set Inlet/Outlet BCs</strong> popup window. To set an RCR boundary condition 
<div style="background-color: #F0F0F0; padding: 10px">
1) From the <b>BC Type</b> list select <strong>RCR</strong> <br>
2) Enter <i>90 0.0008 1200</i> into the <b>$R_p C R_d$</b> text box <br>
3) Select <strong>OK</strong>
</div>
<br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/bcs-right-iliac.png" style="float: left; width: 20%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p><br>
<h4><b> Set <i>cap_aorta_2</i> RCR boundary condition </b></h4>
Double click with the left mouse button on <b>cap_aorta_2</b> under the <strong>Name</strong> column.
This brings up a <strong>Set Inlet/Outlet BCs</strong> popup window. To set the values for the RCR boundary condition
<div style="background-color: #F0F0F0; padding: 10px">
1) From the <b>BC Type</b> list select <strong>RCR</strong> <br>
2) Enter <i>100 0.0004 1100</i> into the <b>$R_p C R_d$</b> text box <br>
3) Select <strong>OK</strong>
</div>
<br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/bcs-left-iliac.png" style="float: left; width: 20%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p>The boundary condition and parameter values for each inlet and outlet faces are now defined and are shown in the
<strong>Inlet and Outlet BCs</strong> panel table. Boundary conditions may also be directly entered into the table by double clicking 
with the left mouse button on the <strong>BC Type</strong> and <strong>Values</strong> columns.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/bcs-values-set.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<!-- -------------------------------------------- -->

<!--           Setting wall properties            -->

<!-- -------------------------------------------- -->

<h3> Set wall properties </h3>

<p>Select the <strong>Wall Properties</strong> sub-panel name to bring up the <strong>Wall Properties</strong> panel used to set the material 
properties for vessel walls.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/wall-props-panel.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p>To set the material model to Olufsen 
<div style="background-color: #F0F0F0; padding: 10px">
1) From the <b>Material Model </b> list select <strong>OLUFSEN</strong> <br>
2) Enter <i> 2.0e7 </i> into the <b>$K_1 $</b> text box <br>
3) Enter <i> 8.65e5  </i> into the <b>$K_3 $</b> text box <br>
4) Enter <i> 113324.0 </i> into the <b>Pressure</b> text box <br>
</div>
<br></p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/wall-props-params.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<!-- -------------------------------------------- -->

<!--           Solver parameters                  -->

<!-- -------------------------------------------- -->

<h3> Set solver parameters </h3>

<p>Select the <strong>Solver Parameters</strong> sub-panel name to bring up the <strong>Solver Parameters</strong> panel used to set the
parameters needed to execute the 1D Solver.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/solver-params-panel.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p>To set the solver parameters 
<div style="background-color: #F0F0F0; padding: 10px">
1) Double click with the left mouse button on the <strong>Number of Timesteps</strong> <strong>Values</strong> column and enter <i>10000</i>. <br>
2) Double click with the left mouse button on the <strong>Time Steps Size</strong> <strong>Values</strong> column and enter <i>0.001</i>. <br>
3) Double click with the left mouse button on the <strong>Number of Timesteps between Saving Data</strong> <strong>Values</strong> column and enter <i>1</i>. <br>
</div>
<br></p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/solver-params-values.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<!-- -------------------------------------------- -->

<!--        Create files and Run simulation       -->

<!-- -------------------------------------------- -->

<h3> Create the 1D Solver input file and run a simulation </h3>

<p>Select the <strong>Create Files and Run Simulation</strong> sub-panel name to bring up the <strong>Create Files and Run Simulation</strong> panel used to 
used to create a 1D solver input file and run the 1D solver.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/create-files-panel.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p>To generate the 1D Solver input file click on the <strong>Create Files for Simulation</strong> button. A popup window is displayed
showing the number of segments, nodes and finite elements created for the 1D simulation. </p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/create-files-popup.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p>Click <strong>OK</strong>.</p>

<p>To run a 1D Solver simulation on the <strong>Run Simulation</strong> button. A popup window is displayed when the simulation finishes. </p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/create-files-run-sim.png" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p>Selecting the <strong>Show Details</strong> button dispays the 1D Solver log file</p>

<div style="background-color: #F0F0F0">
<pre>
<p style="font-size:10px" >
---------------------------------
 oneDSolver 
 1D Finite Element Hemodynamics  
---------------------------------

Reading file: /SVProject/Simulations1d/demo/solver.in ... 

Printing Model Echo ... 

Creating and Running Model ...
Creating Nodes ... 
Creating Joints ... 
Creating Materials ... 
call cvOneMaterialsOlufsen p1_=113324.014500 K3_=0.000000 
Setting material K's 0 -22.5267 1e+07 ...
Setting reference Pressure 0
call SetMaterialType K3_ 10000000.000000 
new cvOneMaterialOlufsen called check pRef 0.000000 
Creating Data Tables ... 
Creating Segments ... 
Solving Model ... 
Inlet Condition Type: FLOW

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Number of Joints: 1
Number of Segments: 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

call cvOneMaterialsOlufsen p1_=113324.014500 K3_=33.690970 
In GetNewInstance cvOneDMaterialOlufsen is called  matID=0 
call cvOneDMaterialOlufsen that this K3_=10000000.000000 p1_=0.000000 
In GetNewInstance cvOneDMaterialOlufsen* materials is called 
subdomain cpp setupMaterial matID=0  
call cvOneMaterialsOlufsen p1_=113324.014500 K3_=0.000000 
In GetNewInstance cvOneDMaterialOlufsen is called  matID=0 
call cvOneDMaterialOlufsen that this K3_=10000000.000000 p1_=0.000000 
In GetNewInstance cvOneDMaterialOlufsen* materials is called 
subdomain cpp setupMaterial matID=0  
RCR boundary condition
call cvOneMaterialsOlufsen p1_=113324.014500 K3_=0.000000 
In GetNewInstance cvOneDMaterialOlufsen is called  matID=0 
call cvOneDMaterialOlufsen that this K3_=10000000.000000 p1_=0.000000 
In GetNewInstance cvOneDMaterialOlufsen* materials is called 
subdomain cpp setupMaterial matID=0  
RCR boundary condition
Subdomain No. 3
Joint No. 1
Outlet No. 2
Number of equations 1303
Using Conservative Form ...
maxStep/stepSize: 10000
Total Solution is: 10000 x 1303
**** Time cycle 1
    iter: 0 normf: 134.606 norms: 0.00421471 time: 0.001614
    iter: 1 normf: 43.8713 norms: 0.0246538 time: 0.001102
    iter: 2 normf: 1.14964 norms: 1.17156e-05 time: 0.001108
    iter: 3 normf: 0.0299168 norms: 5.84007e-08 time: 0.001096
    iter: 4 normf: 0.000699028 norms: 1.16806e-09 time: 0.001097
    iter: 5 normf: 2.68722e-05 norms: 3.94369e-11 time: 0.001097
  Time = 0.001, Mass = 0.0169997, Tot iters = 6
    iter: 0 normf: 81.4714 norms: 0.0257353 time: 0.001099
    iter: 1 normf: 7.04379 norms: 4.91323e-05 time: 0.001204
    iter: 2 normf: 0.288877 norms: 3.82307e-07 time: 0.001262
    iter: 3 normf: 0.0109262 norms: 2.31787e-08 time: 0.001136
...
Time = 9.998, Mass = 0.0889071, Tot iters = 4
    iter: 0 normf: 0.732147 norms: 0.000141274 time: 0.001097
    iter: 1 normf: 0.394251 norms: 0.000232438 time: 0.001099
    iter: 2 normf: 0.0100552 norms: 5.84729e-09 time: 0.001096
    iter: 3 normf: 0.000314998 norms: 4.17093e-11 time: 0.001097
  Time = 9.999, Mass = 0.0899291, Tot iters = 4
    iter: 0 normf: 0.734032 norms: 0.000143682 time: 0.001099
    iter: 1 normf: 0.384852 norms: 0.000227006 time: 0.001096
    iter: 2 normf: 0.00978278 norms: 5.759e-09 time: 0.001096
    iter: 3 normf: 0.000306487 norms: 4.06793e-11 time: 0.001098
  Time = 10, Mass = 0.0908278, Tot iters = 4
demoGroup0_Seg0_flow.dat
demoGroup0_Seg0_area.dat
demoGroup0_Seg0_pressure.dat
demoGroup0_Seg0_Re.dat
demoGroup0_Seg0_wss.dat
demoGroup2_Seg1_flow.dat
demoGroup2_Seg1_area.dat
demoGroup2_Seg1_pressure.dat
demoGroup2_Seg1_Re.dat
demoGroup2_Seg1_wss.dat
demoGroup3_Seg2_flow.dat
demoGroup3_Seg2_area.dat
demoGroup3_Seg2_pressure.dat
demoGroup3_Seg2_Re.dat
demoGroup3_Seg2_wss.dat
Completed!

</p>
</pre>
</div>

<!-- -------------------------------------------- -->

<!--              Convert results                 -->

<!-- -------------------------------------------- -->

<h3> Convert and simulation results </h3>

<p>Select the <strong>Convert Results</strong> sub-panel name to bring up the <strong>Convert Results</strong> panel used to
used to convert 1D solver simulation results to CSV format files.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/convert-results-panel.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p>Set the <strong>Results Directory</strong> by selecting <strong>&hellip;</strong> to bring up a file browser. Navigate to the <strong>/PROJECT/Simulations1d/demo/</strong> 
directory and press <strong>Open</strong>. Set the time range <strong>Start</strong> value 0.0 and the <strong>Stop</strong> value to 0.8. 
From the <strong>Data</strong> scrolling text box select <strong>flow</strong> and <strong>pressure</strong> data. Select the <strong>Convert</strong> button to convert the results.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/convert-results.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p>The CSV files for flow and pressure results are stored in the <strong>/PROJECT/Simulations1d/demo/demo-converted-results</strong> directory. 
The CSV files can be graphed using several applications (gnuplot, MATLAB, ParaView, etc.). Here we have plotted flow results 
using ParaView. </p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/tool/images/tutorial-1/paraview.png" style="float: left; width: 80%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>
</section>
  <section id="tool-refs" class="subgroup"><h2>References</h2>

<p>[1] T.J.R. Hughes and J. Lubliner, <strong>On the One-Dimensional Theory of Blood Flow in the Larger Vessels</strong> , Mathematical Biosciences, 18(1-2) (1973), 161-170.</p>

<p>[2] T.J.R. Hughes, <strong>A Study of the One-Dimensional Theory of Arterial Pulse Propagation</strong>, 1974, U.C. Berkeley, Ph.D. Thesis.</p>
</section>

<section id="solver" class="group"><h1>1D Solver</h1>

<p>The one-dimensional equations for the flow of a Newtonian, incompressible fluid
in a deforming, elastic domain consist of the continuity equation, a single axial momentum balance equation, a constitutive
equation, and suitable initial and boundary conditions. The governing equations are derived in a general form by 
Hughes[2] and Hughes and Lubliner[1].</p>
</section>
  <section id="solver-theory" class="subgroup"><h1>A coupled multi-domain method for 1D hemodynamics</h1>

<p>Flow and pressure waves, originating due to the contraction of the heart, propagate along the deformable vessels and reflect due to tapering, branching, and other discontinuities. The size and complexity of the cardiovascular system necessitate a multidomain approach, with “upstream” regions of interest (large arteries) coupled to reduced-order models of “downstream” vessels. Previous efforts to couple upstream and downstream domains have included specifying resistance and impedance outflow boundary conditions for the nonlinear one-dimensional wave propagation equations and iterative coupling between three-dimensional and one-dimensional numerical methods. We have developed a new approach to solve the one-dimensional nonlinear equations of blood flow in elastic vessels utilizing a space-time finite element method with GLSstabilization for the upstream domain, and a boundary term to couple to the downstream domain. </p>

<p>The outflow boundary conditions are derived following an approach analogous to the Dirichlet-to-Neumann (DtN) method. </p>

<p>In the downstream domain, we solve simplified 0D/1D equations to derive relationships between pressure and flow accommodating periodic and transient phenomena with a consistent formulation for different boundary condition types. In this chapter, we also present a new boundary condition that accommodates transient phenomena based on a Green’s function solution of the linear, damped wave equation in the downstream domain. </p>

<p>The mathematical formulation, the numerical derivation and results are presented in the next sections.</p>

<p>We present here the different steps that are required to develop the coupled multidomain method from the strong form in the original domain to the variational form in the computational domain that includes the information of the analytical domain.</p>

<!--- Strong Form --->

<h2>Strong form</h2>

<p>The one-dimensional equations for the flow of a Newtonian, incompressible fluid in a deforming, elastic domain consist of the continuity 
equation, a single axial momentum balance equation, a constitutive equation, and suitable initial and boundary conditions. The governing 
equations are derived in a general form by Hughes <a href="#ref-2">[2]</a> and 
Hughes and Lubliner <a href="#ref-1">[1]</a>. The partial differential equations for mass and momentum 
balance are given by (z is the axial coordinate):</p>

<p>$$\frac{\partial S}{\partial t} + \frac{\partial Q}{\partial z} = -\psi$$</p>

<p>$$\frac{\partial Q}{\partial t} + \frac{\partial}{\partial z}\left[(1 + \delta)\,\frac{Q^2}{S}\right] + \frac{S}{\rho}\,\frac{\partial p}{\partial z} = S\,f + N\,\frac{Q}{S} + \nu\frac{\partial^2 Q}{\partial z^2}$$</p>

<p>The primary variables are the cross-sectional area $S$, the pressure $p$, and the volumetric flow rate $Q$. 
The density of the fluid is given by ρ (assumed constant), the external force by $f$, the kinematic viscosity by $\nu$ (assumed constant) 
and $\psi$ is an outflow function (taken to be zero for impermeable vessels). 
The variables $\delta$ and $N$ are defined by the choice of a profile function for the velocity over the cross-section. Here we choose 
a time-varying, parabolic flow profile, thus Hughes and Lubliner <a href="#ref-1">[1]</a>:</p>

<p>$$\delta = \frac{1}{3},\quad N = -8\,\pi\,\nu \label{1} \tag{1} $$</p>

<p>The governing equations are of mixed parabolic-hyperbolic type, but have mainly a hyperbolic nature since the diffusive term is small. We thus impose one boundary condition at each inlet/outlet by specifying values of the primary variables or a relationship between them. </p>

<p>The flow rate is typically specified at the inlet(s) ($\Gamma_in$), but the inlet boundaries can accommodate the same types of boundary conditions as will be subsequently discussed for the outlets:</p>

<p>$$ Q(z,t) = Q_in(t),\quad z\in\Gamma_in $$</p>

<p>The initial conditions for this problem are given by (where $S^0(z)$, $Q^0(z)$ and $p^0(z)$ are prescribed functions):</p>

<p>$$ S(z,0) = S^0(z),Q(z,0) = Q^0(z)\,\text{and}\, p(z,0) = p^0(z) $$</p>

<p>In order to complete the above system, we need to introduce a constitutive relationship. An elastic model is assumed, which relates the pressure to the cross-sectional area as follows:</p>

<p>$$p(z,t) = \tilde{p}[S(z,t),z,t]$$</p>

<p>and its inverse function</p>

<p>$$ S(z,t) = \tilde{S}[p(z,t),z,t] \label{2} \tag{2} $$</p>

<p>The particular constitutive relationship that we have used is that proposed by Olufsen <a href="#ref-3">[3]</a>:</p>

<p>$$ \tilde{p}(S,z) = p^0(z) + \frac{4}{3}\,\frac{E\,h}{r^0(z)}\,\left(1 - \sqrt{\frac{S^0(z)}{S(z,t)}}\right) \label{3} \tag{3} $$</p>

<p>here the Young’s modulus $E$ and the wall thickness $h$ relate to the radius $r^0 = \sqrt{S^0(z)/\pi}$:</p>

<p>$$ \frac{E\,h}{r^0(z)} = k_1\,\exp{k_2\,r^0(z)} + k_3 $$</p>

<p>In this relationship, $k_1$, $k_2$, and $k_3$ are empirically-derived constants with values in CGS units of 
$2x10^{7} g⋅ s^{-2}⋅ cm^{-1}$, $-22.53 cm^{-1}$, and $8.65 x 10^{5} g⋅ s^{-2}⋅ cm^{-1}$, respectively. 
Here we use a constant initial pressure $p^0(z) = p^0$. By noting that the pressure gradient can be expanded as</p>

<p>$$ \frac{\partial p}{\partial z} = \frac{\partial\tilde{p}}{\partial S}\,\frac{\partial S}{\partial z} + \frac{\partial\tilde{p}}{\partial z} $$</p>

<p>we can rewrite the system of partial differential equations in the following quasi-linear conservative form:</p>

<p>$$ \frac{\partial\mathbf{U}}{\partial t} + \frac{\partial\mathbf{F}}{\partial z} - \mathbf{K}\,\frac{\partial^2\mathbf{U}}{\partial z^2} = G,\,\text{or}\quad\frac{\partial\mathbf{U}}{\partial t} + \frac{\partial\mathbf{F}}{\partial z} - \mathbf{K}\,\frac{\partial^2\mathbf{U}}{\partial z^2} = \mathbf{C}_F\,\mathbf{U} $$</p>

<p>where</p>

<p>$$ \mathbf{U} = \begin{bmatrix}U_1\ \cr U_2 \end{bmatrix} = \begin{bmatrix} S \cr Q \end{bmatrix} \label{4} \tag{4} $$</p>

<p>$$ \mathbf{F} = \begin{bmatrix} U_2 \cr (1 + \delta)\,\frac{U_2^2}{U_1} + \frac{1}{\rho}\,\int_{p^0}^{p(z,t)}\tilde{S}(p,z,t)\,dp \end{bmatrix}, \quad \mathbf{K} = \begin{bmatrix} 0 &amp; 0 \cr 0 &amp; \nu\ \end{bmatrix} $$</p>

<p>$$ \mathbf{G} = \begin{bmatrix} -\psi \cr U_1\,f + N\,\frac{U_2}{U_1} + \int_{p^0}^{p}\frac{1}{\rho}\,\frac{\partial\tilde{S}(p,z,t)}{\partial z}\,dp \end{bmatrix},\quad $$</p>

<p>$$ \mathbf{C}_F = \begin{bmatrix} -\frac{\psi}{U_1} &amp; 0 \cr f + \frac{1}{U_1}\,\int_{p^0}^{p}\frac{1}{\rho}\,\frac{\partial\tilde{S}(p,z,t)}{\partial z}\,dp &amp; \frac{N}{U_1} \end{bmatrix} $$</p>

<p>The motivation to work with the conservative form rather than the advective form as in previous work <a href="#ref-4">[4]</a>, is to be able to integrate by part the convective term and obtain a flux (a boundary integral) through which the multidomain coupling can be performed.</p>

<p>Note that in the advective form, the only term that can easily be integrated by parts is the longitudinal viscous term, which is very small and often neglected in one-dimensional theory. Thus, the main difference between the two forms is the treatment of the boundary conditions. </p>

<p>In the present conservative formulation, boundary conditions are prescribed in a natural way. In contrast, in the advective form, boundary conditions are enforced in an essential way: the equation for the corresponding dof is replaced by an equation representing the boundary condition.</p>

<h2> Weak form </h2>

<p>The weak formulation of the initial boundary value problem is given as follows with $\Omega = [0, L]$ : find $\mathbf{U}$ in $\mathcal{V} = {\mathbf{U}:\Omega\times (0,T)\rightarrow\mathbb{R}^2\,|\,\mathbf{U}(z,t)\in H_0^1}$ such that $\forall\,\mathbf{W} = \left[W_1\,W_2\right]^T\in\mathcal{V}$,</p>

<p>$$ \begin{eqnarray}
   &amp; \int_{0}^{t}\int_{0}^{L}\left(-\mathbf{W}_{,t}^T\,\mathbf{U} - \mathbf{W}_{,z}^T\,\mathbf{F} + \mathbf{W}_{,z}^T\,\mathbf{K}\,\mathbf{U}_{,z}-\mathbf{W}^T\,\mathbf{G}\right)\,dz\,dt + \int_{0}^{T} \left[\mathbf{W}^T\left(\mathbf{F}-\mathbf{K}\mathbf{U}_{,z}\right)\right]\_{0}^{L}\,dt + \cr
   &amp; \int_{0}^{L}\mathbf{W}^T(z,T)\mathbf{U}(z,T)\,dz - \cr
   &amp; \int_{0}^{L}\mathbf{W}^T(z,0)\,\mathbf{U}^0(z)\,dz = 0
   \end{eqnarray} $$</p>

<p>where the initial condition is given by $\mathbf{U}^0(z) = \left[S^0(z),Q^0(z)\right]^T$. 
The boundary conditions are not specified at this point.</p>

<h2> Disjoint Decomposition </h2>

<p>We adopt the disjoint decomposition approach described in 2.3 to derive appropriate outflow boundary conditions. 
First, we divide our spatial domain $\Omega=[0,L]$ into an upstream <strong>numerical</strong> domain $\Omega^{n}: z\in(0,B)$, 
and a downstream <strong>analytic</strong> domain $\Omega^{a}: z\in(B,L)$.</p>

<p>The boundary that separates these domains is defined as $\Gamma_{B} : z = B$. We define a disjoint decomposition of 
our variables, for example for our unknown solution vector $\mathbf{U}$</p>

<p>$$\mathbf{U} = \mathbf{U}^{n} + \mathbf{U}^{a}$$</p>

<p>so that</p>

<p>$$\mathbf{U} = \begin{cases} \mathbf{U}^{n} &amp; z\in\Omega^{n} \cr \mathbf{U}^{a} &amp; z\in\Omega^{a} \end{cases}$$</p>

<p>We use a similar decomposition for our weighting function, $\mathbf{W}$ , and insert these expressions into our variational form. </p>

<p>The disjoint nature of this expression is used to derive a new variational form for the 1D numerical domain: we obtain the original variational form specialized to the 1D numerical domain $\Omega^{n}$ with the addition of a boundary term accounting for the interface to the 1D analytic domain, $\Omega^{a}$</p>

<p>$$\begin{eqnarray}
   &amp; \int_{0}^{t}\int_{0}^{B}\left(-\mathbf{W}_{,t}^{n\,T}\,\mathbf{U}^{n} - \mathbf{W}_{,z}^{n\,T}\,\mathbf{F}(\mathbf{U}^{n}) + \mathbf{W}_{,z}^{n\,T}\,\mathbf{K}\,\mathbf{U}^{n}_{,z}-\mathbf{W}^{n\,T}\,\mathbf{G}(\mathbf{U}^{n})\right)\,dz\,dt \cr
   &amp; -\int_{0}^{B}\,\mathbf{W}^{n\,T}(z,T)\,\mathbf{U}^{n}(z,T)\,dz + 
   \int_{0}^{B}\mathbf{W}^{n\,T}(z,0)\,\mathbf{U}^{n}(z,0)\,dz + \cr
   &amp; \int_{0}^{T}\left[\mathbf{W}^{n\,T}\left(\mathbf{F}(\mathbf{U}^{n}) - \mathbf{K}\,\mathbf{U}^{n}_{,z}\right)\right]_{z=0}\,dt - 
   \int_{0}^{T}\left[\mathbf{W}^{a\,T}\left(\mathbf{F}(\mathbf{U}^{a}) - \mathbf{K}\,\mathbf{U}^{a}_{,z}\right)\right]_{z=B}\,dt = 0
   \end{eqnarray} \label{5} \tag{5} $$</p>

<p>Now, we enforce the continuity of the weighting function at the interface:</p>

<p>$$ \mathbf{W}^{a}\vert_{z=B} = \mathbf{W}^{n}\vert_{z=B} $$</p>

<p>and define the operators $\mathbf{M}$ and $\mathbf{H}$ on the $\Omega^{a}$ domain based on the model of the
downstream domain:</p>

<p>$$\left[\mathbf{M}(\mathbf{U}^{a})\right]_{z=B} = \left[\mathbf{F}(\mathbf{U}^{a}) - \mathbf{K}\mathbf{U}^{a}_{,z}\right]_{z=B} $$</p>

<p>$\mathbf{M}$ acts on the solution variables and $\mathbf{H}$ depends only on other terms like initial conditions, boundary conditions, and physical properties in the downstream domain. </p>

<p>Finally, we enforce the continuity of the flux at the boundary:</p>

<p>$$ \left[\mathbf{M}(\mathbf{U}^{n})\right]_{z=B} = \left[\mathbf{M}(\mathbf{U}^{a})\right]_{z=B}  \label{6} \tag{6} $$</p>

<p>The final result is</p>

<p>$$ \begin{eqnarray}
   &amp; \int_{0}^{t}\int_{0}^{B}\left(-\mathbf{W}_{,t}^{n\,T}\,\mathbf{U}^{n} - \mathbf{W}_{,z}^{n\,T}\,\mathbf{F}(\mathbf{U}^{n}) + \mathbf{W}_{,z}^{n\,T}\,\mathbf{K}\,\mathbf{U}^{n}_{,z}-\mathbf{W}^{n\,T}\,\mathbf{G}(\mathbf{U}^{n})\right)\,dz\,dt \cr
   &amp; -\int_{0}^{B}\,\mathbf{W}^{n\,T}(z,T)\,\mathbf{U}^{n}(z,T)\,dz + 
   \int_{0}^{B}\mathbf{W}^{n\,T}(z,0)\,\mathbf{U}^{n}(z,0)\,dz + \cr
   &amp; \int_{0}^{T}\left[\mathbf{W}^{n\,T}\left(\mathbf{F}(\mathbf{U}^{n}) - \mathbf{K}\,\mathbf{U}^{n}_{,z}\right)\right]_{z=0}\,dt - 
   \int_{0}^{T}\left[\mathbf{W}^{n\,T}\left(\mathbf{M}(\mathbf{U}^{n}) + \mathbf{H}\right)\right]_{z=B}\,dt = 0
   \end{eqnarray} $$</p>

<p>We see that the solution in the numerical domain depends on the operators $\mathbf{M}$ and $\mathbf{H}$ defined by the mathematical model of the downstream domain but not the solution
variable, $\mathbf{U}^{a}$, in the downstream domain.</p>

<h2> The Map from the “DtN” Method </h2>

<p>The operators $\mathbf{M}$ and $\mathbf{H}$ are based on the mathematical model of the downstream domain using an approach based on the “Dirichlet-to-Neumann” method <a href="#ref-5">[5-7,9]</a>.
The physics of the downstream domain depends on the upstream domain. Thus, an explicit solution on the downstream domain cannot be obtained. Instead, a relationship between the unknowns that incorporates all the information of the model, the <em>map</em>, is
derived. 
The DtN map is then inserted into the flux term previously described $eq20$, to derive the operators $\mathbf{M}$ and $\mathbf{H}$. 
In practice, the contribution of the diffusive flux term $\mathbf{K}\mathbf{U}_{,z}$ is observed to be negligible 
in the boundary integral and is hence omitted in deriving an expression for $\mathbf{M}$ and $\mathbf{H}$ from 
equations $\eqref{4}$ and $\eqref{6}$:</p>

<p>$$ \begin{eqnarray}
   M_1(Q,S) + H_1 &amp; = Q \cr
   M_2(Q,S) + H_2 &amp; = (1 + \delta)\,\frac{Q^2}{S} + \frac{1}{\rho}\int_{p_0}^{p} \tilde{S}(p,z,t)\,dp
   \end{eqnarray} \label{7} \tag{7} $$</p>

<p>Note that the boundary conditions are not exact since, at a minimum, a linear approximation is employed in the downstream domain whereas a nonlinear model is used in the upstream domain.</p>

<h3> Resistance (0D, constant in time) </h3>

<p>We can distinguish between instantaneous and memory cases. An example of an instantaneous map is when a simple proportional relationship is prescribed between pressure at time $t$ and flow at the same point in time that represents the resistance to flow
of the downstream domain, $Q(B,t) = p(B,t)/R$. The resistance $R$ can be measured, taken from the literature or derived for Poiseuille flow (steady flow) or other models. 
Then using equations $\eqref{1}$, $\eqref{2}$, $\eqref{3}$, and integrating the pressure term in $\eqref{7}$:</p>

<p>$$\begin{eqnarray}
   M_1(S) &amp; = \frac{\tilde{p}(S,B)}{R},\quad H_1 = 0 \cr
   M_2(S) &amp; = \frac{4}{3}\,\frac{M_1(S)^2}{S} + frac{4\,\sqrt{\pi}}{3}\,\frac{E\,h}{\rho}\,\sqrt{S},\quad H_2 = -\frac{4}{3\,\rho}\,E\,h\,\pi\,r^{0}(B)
   \end{eqnarray}$$</p>

<h3> Windkessel RCR circuit model (0D, fully transient) </h3>

<p>Flow and pressure are related by the following relationship</p>

<p>$$Q(B,t) = \left[Q(B,0) - \frac{p^0(B)}{R}\right]\exp(-\alpha\,t) + \frac{p(B,t)}{R} - \frac{1}{R^2\,C}\,\int_{0}^{t} p(B,\tau)\exp(-\alpha(t-\tau))\,d\tau$$</p>

<p>$$\alpha = \frac{R + R_d}{R\,R_d\,C}$$</p>

<p>Then using equations $\eqref{1}$, $\eqref{2}$ and $\eqref{3}$, and integrating the pressure term in $\eqref{7}$:</p>

<p>$$M_1(S) = \frac{\tilde{p}[S(B,t),B,t]}{R} - \frac{1}{R^2\,C}\,\int_{0}^{t}\tilde{p}[S(B,\tau),B,\tau]\,\exp(-\alpha(t-\tau))\,d\tau$$</p>

<p>$$H_1 = \left[Q(B,0) - \frac{p^0(B)}{R}\right]\exp(-\alpha\,t)$$</p>

<p>$$M_2(S) = \frac{4}{3}\,\frac{[M_1(S) + H_1]^2}{S} + \frac{4\,\sqrt{\pi}}{3}\,\frac{E\,h}{\rho}\,\sqrt{S}$$</p>

<p>$$H_2 = -\frac{4}{3\,\rho}\,E\,h\,\pi\, r^{0}(B)$$</p>

<p>The flow rate at time $t$ depends on the entire history of the pressure represented by the time integral in the above equations.</p>

<h3> Impedance (1D, periodic) </h3>

<p>Another example of a memory map is the impedance model: the downstream domain is approximated using linear wave propagation theory and we further assume that the solution is periodic in time. We can then derive</p>

<p>$$Q(B,t) = \frac{1}{T}\int_{t-\tau}^{t}\,p(B,\tau)\,y(B,t-\tau)\,d\tau \label{8}  \tag{8} $$</p>

<p>The flow rate at time $t$ depends on the history of the pressure over one period. Here $y(B,t)$ is the inverse Fourier transform of the admittance function 
The representation formula for the operators then reads, using equations $\eqref{1}$, $\eqref{2}$, $\eqref{3}$,
$\eqref{7}$, $\eqref{8}$:</p>

<p>$$M_1(S) = \frac{1}{T}\,\int_{t-\tau}^{t}\,\tilde{p}\left[S(B,\tau),B\right]\,y(B,t-\tau)\,d\tau,\quad H_1=0$$</p>

<p>$$M_2(S) = \frac{4}{3}\,\frac{M_1(S)^2}{S} + \frac{4\,\sqrt{\pi}}{3}\,\frac{E\,h}{\rho}\,\sqrt{S},\quad H_2 = -\frac{4}{3\,\rho}\,E\,h\,\pi\, r^{0}(B)$$</p>

<p>The flow rate at time $t$ depends on the history of the pressure over one cardiac cycle represented by the time integral in the above equations.</p>

<h3> Wave in a tube (1D, fully transient) </h3>

<p>Another example of a memory map is the more general one-dimensional wave equation. The derivation of a minimally reflecting boundary condition for the one-dimensional non-linear equations using the wave equation for the downstream domain has been inspired by the work of Givoli, Grote and colleagues <a href="#ref-7">[7-9]</a> on exact nonreflecting boundary conditions for the linear wave equation. 
For this latter case, we approximate the downstream domain using one-dimensional linear wave propagation theory but do not assume periodicity in time. 
As an example, in the case where the downstream domain is a single elastic vessel with length $l$ and wave speed $c$, going from the boundary point $B$ to the far end point $L$, we derived a map with the related Green’s function that relates cross-sectional area and its derivative at the inlet of a segment:</p>

<p>$$\frac{\partial S}{\partial z}(B,t) = -\frac{S(B,t)}{l} + \exp(\gamma\, t)\,\int_{0}^{t}\int_{B}^{L}\,\frac{\partial G}{\partial z}(B,t,z_0,t_0)\,f_B(z_0,t_0)\,dz_0\,dt_0 + \mathcal{H}(t)$$</p>

<p>Furthermore we integrate the balance of momentum equation in time to obtain:</p>

<p>$$Q(B,t) = -c^2\,\int_{0}^{t}\,\frac{\partial S}{\partial z}(B,t)\,\exp(2\gamma(t-t_0))\,dt_0 + Q^0(B)\exp(2\,\gamma\,t)$$</p>

<p>We can then derive a map between the flow rate and the cross-sectional area using (3.29) and (3.30):</p>

<p>$$Q(B,t) = 
   c^2\,\int_{0}^{t}\left[\frac{S(B,t^{*})}{l} - \exp(\gamma\,t^{*})\,\int_{0}^{t^{*}}\int_{B}^{L}\frac{\partial G}{\partial z}(B,t^{*},z_0,t_0)\,f_{B}(z_0,t_0)\,dz_0\,dt_0\right]\exp(2\,\gamma\,(t-t^{*}))\,dt^{*} + 
   c^2\,\int_{0}^{t}\mathcal{H}(t^{*})\exp(2\,\gamma\,(t-t^{*}))\,dt^{*} + Q^0(B)\exp(2\,\gamma\,t) $$</p>

<p>After integrating by parts in time, the derivatives that constitute $f_B(z_0,t_0)$, and using the 
Green’s function $\eqref{5}$, the final map reads:</p>

<p>$$Q(B,t) = \frac{c^2}{l}\,\int_{0}^{t}\left[1 + \sum_{n=1}^{\infty}2\right]\,S(B,t^{*})\exp(2\,\gamma\,(t-t^{*}))\,dt^{*}
   -\left(\frac{c}{l}\right)^3\,\int_{0}^{t}\exp(\gamma\,(2\,t - t^{*}))\int_{0}^{t^{*}}\,S(B,t_0)\exp(-\gamma\,t_0)\left[\sum_{n=1}^{\infty}\frac{2\,n^2\,\pi^2}{\sqrt{\lambda_n}}\,\sin(c\,\sqrt{\lambda_n}(t^{*}-t_0))\right]\,dt_0\,dt^{*}
    + Q^0(B)\exp(2\,\gamma\,t) + \Theta\,\left[S^0(B), \dot{S}_0(B), S_L(t),\dot{S}_L(t),\ddot{S}_L(t)\right] \label{9} \tag {9} $$</p>

<p>and</p>

<p>$$\Theta\,\left[S^0(B), \dot{S}_0(B), S_L(t),\dot{S}_L(t),\ddot{S}_L(t)\right] = - \left[\sum_{n=1}^{\infty}\frac{2\,c}{l\,\sqrt{\lambda_n}}\,\sin(c\,\sqrt{\lambda_n}\,t)\right]\exp(\gamma\,t)\,S(B,0) 
   + \left[\sum_{n=1}^{\infty}\,\frac{2\,l}{c\,n^2\,\pi^2\,\sqrt{\lambda_n}}\left(\gamma\,\sin(c\,\sqrt{\lambda}\,t)\right) + c\,\sqrt{\lambda_n}\,\left(\cos(c\,\sqrt{\lambda_n}\,t) - \exp(\gamma\,t)\right)\right]\exp(\gamma\,t)\,\dot{S}(B,0) + 
   -c^2\int_{0}^{t}\mathcal{H}(t^{*})\exp(2\,\gamma\,(t-t^{*}))\,dt^{*}$$</p>

<p>The operators for the wave boundary condition can now be derived using $\eqref{7} and $\eqref{9},, assuming as for the upstream numerical domain that the initial cross-sectional area is the same as the reference cross-sectional area:</p>

<p>$$Q(B,t) = M_1(S) + H_1,\, \gamma = \frac{N}{2\,S^{0}},\, \forall n \in \mathbb{N}_{&gt;0},\,\lambda = \frac{n^2\,\pi^2}{l^2} - \frac{\gamma^2}{c^2}$$</p>

<p>$$M_1(S) = \frac{c^2}{l}\int_{0}^{t}\left[1 + \sum_{n=1}^{\infty}\,2\right]\,S(B,t^{*})\exp\left[2\gamma(t-t^{*})\right]\,dt^{*} 
   - \left(\frac{c^2}{l}\right)^3\,\int_{0}^{t}\exp\left[\gamma(2t - t^{*})\right]\int_{0}^{t^{*}}S(B,t_0)\exp(-\gamma\,t_{0})\left[\sum_{n=1}^{\infty}\frac{2\,n^2\,\pi^2}{\sqrt{\lambda_n}}\,sin\left(t^{*} - t_{0}\right)\right]\,dt_0\,dt^{*}$$</p>

<p>$$H_1 = Q^{0}(B)\exp\left(2\,\gamma\,t\right) + \Theta\left[S^0(B), \dot{S}^{0}(B), S_L(t), \dot{S}_L(t), \ddot{S}_L(t)\right]$$</p>

<p>$$M_2(S) = \frac{4}{3}\frac{\left[M_1(S) + H_1\right]^2}{S} + \frac{4\,\sqrt{\pi}}{3}\frac{E\,h}{\rho}\sqrt{S}$$</p>

<p>$$H_2 = -\frac{4}{3\,\rho}\,E\,h\,\pi\,r^0(B)$$</p>

<p>The flow rate is a function of pressure history and depends also on waves coming from the far end boundary conditions and the initial conditions everywhere in the downstream domain. 
For simplicity, we implemented the equation above assuming that the initial state corresponded to the static solution around which the wave equation is derived, with zero initial derivative of the cross-sectional area and a constant distant cross-sectional area.</p>

<p>The <em>DtN</em> map has now been derived for a variety of boundary conditions. The reader interested in the effect of a different boundary condition can follow the same approach to derive the corresponding map. 
In particular, this approach can be applied for complex lumped models of the coronary bed, and can also be performed very similarly for lumped-parameter heart models at the inlet of the numerical domain.</p>

<h2> Finite Element Discretization </h2>

<p>We employ a stabilized space-time finite element method, known for its robustness, based on the Discontinuous Galerkin method in time. The procedure presented herein employs ideas developed in Hughes and Mallet <a href="#ref-10">[10]</a> and Hughes, Franca and Hulbert <a href="#ref-11">[11]</a>. 
We previously <a href="#ref-4">[4]</a> described a space-time method with flow rate, pressure and resistance boundary conditions that employed a  different strong form (non conservative).
Here we retained the same stabilization term. The present formulation accommodates more general inflow and outflow boundary conditions. We use shape functions that are piecewise constant in time and piecewise linear in space. 
Let $\tilde{\mathcal{V}}$ be the finite-dimensional approximation of $\mathcal{V}$ restricted to $(0,B)\times(t_n,t_n+1)$. Thus, the weak form for slab $n+1$, from $t_n$ to $t_n+1$ reads:</p>

<p>Find $\mathbf{U^h}$ in $\mathbf{V^h}$ such that $\forall\mathbf{W^h}$ in $\mathbf{V^h}$.</p>

<p>$$\int_{t_n^{+}}^{t_{n+1}^{-}}\int_{0}^{B}\left[\mathbf{W}_{,t}^{T}\,\mathbf{U}^{\mathbf{h}} + 
  \mathbf{W}_{,z}^{T}\,\mathbf{F}(\mathbf{U}) - 
  \mathbf{W}_{,z}^{T}\,\mathbf{K}\,\mathbf{U}_{,z} + 
  \mathbf{W}^{T}\,\mathbf{G}\left(\mathbf{U}\right)
  \right]\,dz\,dt $$
  $$ - \int_{0}^{B}\mathbf{W}^{T}\left(z,t_{n+1}^{-}\right)\,\mathbf{U}\left(z,t_{n+1}^{-}\right)\,dz 
  + \int_{0}^{B}\,\mathbf{W}^{T}\left(z,t_{n+1}^{+}\right)\,\mathbf{U}\left(z,t_{n+1}^{-}\right)\,dz $$</p>

<p>$$ + \int_{t_{n}^{+}}^{t_{n+1}^{-}}{\mathbf{W}[\mathbf{F}(\mathbf{U}) - 
  \mathbf{K}\,\mathbf{U}_{,z}]}_{z = 0}\,dt
  - \int_{t_{n}^{+}}^{t_{n+1}^{-}}{\mathbf{W}[\mathbf{M}(\mathbf{U}) + \mathbf{H}]}_{z = B}\,dt = 0$$</p>

<p>For simplicity, we have dropped the superscript $h$. After discretization in time, (3.34) becomes 
(the superscript $n+1$ refers to time slab $n+1$):</p>

<p>$$\Delta t_n\int_{0}^{B}\left[\mathbf{W}_{,z}^{T,n+1}\,\mathbf{F}^{n+1}(\mathbf{U^{n+1}}) - \mathbf{W}_{,z}^{T,n+1}\,\mathbf{K}\,\mathbf{U}_{,z}^{n+1} + \mathbf{W}^{T,n+1}\,\mathbf{G}^{n+1}(\mathbf{U}^{n+1})\right]\,dz $$</p>

<p>$$ - \int_{0}^{B}\,\mathbf{W}^{T,n+1}\left(\mathbf{U}^{n+1} - \mathbf{U}^{n}\right)\,dz
   + \Delta t_{n}\left[\mathbf{W}^{T,n+1}\left(\mathbf{F}^{n+1}(\mathbf{U}^{n+1}) - \mathbf{K}\,\mathbf{U}_{,z}^{n+1}\right)\right]_{z=0}
   - \int_{t_n^{+}}^{t_{n+1}^{-}}\left[\mathbf{W}^{T,n+1}\left(\mathbf{M}^{n+1}(\mathbf{U}) + \mathbf{H}^{n+1}\right)\right]_{z=B} = 0 \label{10} \tag{10} $$</p>

<p>The boundary term appears in the box in this last equation. 
Stabilization terms are added to $\eqref{10}$. To that end, we define the matrices $\mathbf{A}$ and $\mathbf{C_A}$:</p>

<p>$$\mathbf{A} = 
   \begin{bmatrix}
   0 &amp; 1 \cr
   -(1 + \delta)\,\left(\frac{U_2}{U_1}\right)^2 + \frac{U_1}{\rho}\frac{\partial\tilde{p}}{\partial S} &amp; (1 + \delta)\,\frac{2\,U_2}{U_1} \cr
   \end{bmatrix} $$</p>

<p>$$\mathbf{C_A} = 
   \begin{bmatrix}
   -\frac{\psi}{U_1} &amp; 0 \cr
   f-\frac{1}{\rho}\,\frac{\partial\tilde{p}}{\partial z} &amp; \frac{N}{U_1} \cr
   \end{bmatrix}<br>
   $$</p>

<p>We also define the matrix differential operator:</p>

<p>$$\mathcal{L}(\mathbf{U}) = \mathbf{I}\,\frac{\partial}{\partial t} + \mathbf{A}(\mathbf{U})\,\frac{\partial}{\partial z} - \mathbf{K}\,\frac{\partial^2}{\partial z^2} - \mathbf{C_A}(\mathbf{U})
   $$</p>

<p>Note that $\mathcal{L}(\mathbf{U})\,\mathbf{U}$ is the residual of the advective form of the partial differential equation system. For the current case of a piecewise constant approximation in time and a piecewise linear approximation in space this simplifies to</p>

<p>$$\mathcal{L}(\mathbf{U})\,\mathbf{U} = \mathbf{A}(\mathbf{U})\,\mathbf{U}_{,z} - \mathbf{C_A}(\mathbf{U})\,\mathbf{U}$$</p>

<p>The stabilization term takes the form:</p>

<p>$$\Delta t_n\sum_{e}\int_{\Omega_e}\left(\mathcal{L}(\mathbf{U})^T\,\mathbf{W}\right)^T\boldsymbol{\tau}\,\mathcal{L}(\mathbf{U})\,\mathbf{U}\,dz $$</p>

<p>The summation ranges over the element interiors and $\tau = \tau(\mathbf{U})$ is the stabilization matrix defined by:</p>

<p>$$\boldsymbol{\tau} = \left[\frac{2}{\Delta t_n}\mathbf{I} + \frac{2}{h}\vert\mathbf{A}\vert + 3\,\left(\frac{2}{h}\right)^2\,\mathbf{K} + \vert\mathbf{C_A}\vert\right]^{-1}
   $$</p>

<p>Here, the absolute value of a 2x2 matrix B can be obtained from the Cayley-Hamilton theorem,</p>

<p>$$
   \vert\mathbf{B}\vert = \frac{\mathbf{B}^2 + \sqrt{det(\mathbf{B}^2)}\,\mathbf{I}}{\sqrt{tr(\mathbf{B}^2) + 2\,\sqrt{det(\mathbf{B}^2)}}}
   $$</p>

<p>Therefore the final variational problem is: find $\mathbf{U}^{n+1}$ such that $\forall\,\mathbf{W}$:</p>

<p>$$
  \Delta t_n\int_{0}^{B}\left[\mathbf{W}_{,z}^{T,n+1}\,\mathbf{F}^{n+1}(\mathbf{U^{n+1}}) - \mathbf{W}_{,z}^{T,n+1}\,\mathbf{K}\,\mathbf{U}_{,z}^{n+1} + \mathbf{W}^{T,n+1}\,\mathbf{G}^{n+1}(\mathbf{U}^{n+1})\right]\,dz
$$ 
  $$- \int_{0}^{B}\,\mathbf{W}^{T,n+1}\left(\mathbf{U}^{n+1} - \mathbf{U}^{n}\right)\,dz
  + \Delta t_{n}\left[\mathbf{W}^{T,n+1}\left(\mathbf{F}^{n+1}(\mathbf{U}^{n+1}) - \mathbf{K}\,\mathbf{U}_{,z}^{n+1}\right)\right]_{z=0} $$</p>

<p>$$- \int_{t_n^{+}}^{t_{n+1}^{-}}\left[\mathbf{W}^{T,n+1}\left(\mathbf{M}^{n+1}(\mathbf{U}) + \mathbf{H}^{n+1}\right)\right]_{z=B} = 0 $$
  $$ + \Delta\,t_{n}\sum_{e}\int_{\Omega_e}\left(\mathbf{W}_{,z}^{T}\,\mathbf{A}^{n+1} - \mathbf{W}^{T}\,\mathbf{C}_{A}^{n+1}\right)\boldsymbol{\tau}\left(\mathbf{A}^{n+1}\mathbf{U}_{,z}^{n+1} - \mathbf{C}_{A}^{n+1}\,\mathbf{U}^{n+1}\right)\,dz = 0
   $$</p>

<p>Using piecewise linear shape functions in space $N_A, A = 1,\dots, m$ with $m$ the number of nodes, the global nodal residual is:</p>

<p>$$
  \mathbf{R}_{A} = \Delta\,t_{n}\,\int_{0}^{B}\,N_{A,z}\left(\mathbf{F}^{n+1}(\mathbf{U}^{n+1}) - \mathbf{K}\,\mathbf{U}_{,z}^{n+1}\right) + N_{A}\,\mathbf{G}^{n+1}(\mathbf{U^{n+1}})\,dz
  $$</p>

<p>$$ - \int_{0}^{B}\,N_{A}\left(\mathbf{U}^{n+1} - \mathbf{U}^{n}\right)\,dz
  + \Delta\,t_n\left[N_{A}\left(\mathbf{F}^{n+1}(\mathbf{U}^{n+1}) - \mathbf{K}\,\mathbf{U}_{,z}^{n+1}\right)\right]_{z=0}
  $$</p>

<p>$$
  - \int_{t_{n}^{+}}^{t_{n+1}^{-}}\left[N_{A}\left(\mathbf{M}^{n+1}(\mathbf{U}) + \mathbf{H}^{n+1}\right)\right]_{z=B}\,dt
  $$</p>

<p>$$ + \Delta\,t_{n}\,\sum_{e}\,\int_{\Omega_e}\left(N_{A,z}\,\mathbf{A}^{n+1} - N_{A}\,\mathbf{C}_{A}^{n+1}\right)\,\boldsymbol{\tau}\,\left(\mathbf{A}^{n+1}\,\mathbf{U}_{,z}^{n+1} - \mathbf{C}_{A}^{n+1}\,\mathbf{U}^{n+1}\right)\,dz = 0
  $$</p>

<p>These nonlinear equations are then solved with a modified Newton-Raphson technique <a href="#ref-4">[4]</a>. At each iteration k+1 in the time step n+1, the non-linear loop consists of two steps:</p>

<p>Solve for the increment $\Delta\mathbf{U}_{C}^{n+1,k+1}$:</p>

<p>$$
   \mathbf{K}_{AC}^{n+1,k}\,\Delta\mathbf{U}_{C}^{n+1,k+1} = -\mathbf{R}_{A}^{n+1,k},\quad\text{with}\quad\mathbf{K}_{AC}^{n+1,k} = \frac{\partial\mathbf{R}_{A}^{n+1,k}}{\partial\mathbf{U}_{C}},\quad A,C=1,\dots,m
   $$</p>

<p>Update the solution:</p>

<p>$$
   \mathbf{U}_{C}^{n+1,k+1} = \mathbf{U}_{C}^{n+1,k} + \Delta\mathbf{U}_{C}^{n+1,k+1}
   $$</p>

<p>The matrices $\mathbf{A}$, $\mathbf{C^A}$, $\mathbf{C^F}$ (recall :eq:$eq13$) and $\tau$ are frozen in the calculation of the tangent matrix:</p>

<p>$$ \mathbf{K}_{AC} = \Delta\,t_n\,\int_{0}^{B}\,N_{A,z}\,\left(\frac{\partial\,\mathbf{F}^{n+1,k}}{\partial\,\mathbf{U}_{C}^{n+1,k}} 
  - \mathbf{K}\,N_{C,z}\right) + N_A\,N_C\,\mathbf{C}_{F}^{n+1,k}\,dz $$</p>

<p>$$ - \int_{0}^{B}\,N_A\,N_C\,\mathbf{I}\,dz $$</p>

<p>$$ + \Delta\,t_n\left[N_A\left(\frac{\partial\,\mathbf{F}^{n+1,k}}{\partial\,\mathbf{U}_{C}^{n+1,k}} - \mathbf{K}\,N_{C,z}\right)\right]_{z=0} $$</p>

<p>$$ - \int_{t_n^{+}}^{t_{n+1}^{-}}\,\left[N_A\,\frac{\partial\,\mathbf{M}^{n+1,k}}{\partial\,\mathbf{U}_{C}^{n+1,k}}\right]_{z=B}\,dt $$</p>

<p>$$ + \Delta\,t_{n}\,\sum_{e}\,\int_{\Omega_e}\left(N_{A,z}\,\mathbf{A}^{n+1} - N_{A}\,\mathbf{C}_{A}^{n+1}\right)\,\boldsymbol{\tau}\,\left(\mathbf{A}^{n+1}\,\mathbf{U}_{,z}^{n+1} - \mathbf{C}_{A}^{n+1}\,\mathbf{U}^{n+1}\right)\,dz = 0 $$</p>

<p>After the residual converges to a chosen tolerance, the scheme is advanced in time to solve for a new time step, initialized with the solution at the previous time step.</p>

<p><strong>Remark 1</strong> In practice, the residuals and the tangent matrices are coded at the element level. The detailed finite element  residuals and tangent matrices are presented for reference in Appendix A for each boundary condition.</p>

<p><strong>Remark 2</strong> So far, we have presented the derivation for a single segment. At a connection of multiple segments, pressure continuity and conservation of mass are enforced using Lagrange multipliers. Pressure, cross-sectional area and flow rate boundary conditions are treated as essential boundary conditions. 
Both of these features are exactly the same as in Wan et al. <a href="#ref-4">[4]</a> and are therefore not repeated here.</p>
</section>
  <section id="solver-user-guide" class="subgroup"><h1>User Guide </h1>

<p>This section describes the concepts needed to define a 1D network model and execute a 1D simulation for it. </p>

<h3> Nodes, Joints and Segments </h3>

<p>In the 1D formulation the arterial network is decomposed into arterial segments connected to each other at nodes. The 1D network
geometry is defined by the 3D coordinates of its nodes. </p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/solver/images/3d-model.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <img src="documentation/1d_simulation/solver/images/1d-network-model.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
  <figcaption> <i>Figure 1. The geometriy of a 3D model (left) is represented by a 1D network (right) of Segments (green) and Nodes (blue). </i></figcaption>
</figure>
<br></p>

<p>A segment is used to represent a section of a vessel as a tapered cylinder with a reducing cross sections from inlet to outlet. 
A segment can connect to two joints, a joint and an inlet/outlet, or an inlet to an outlet. A joint is used to 
enforce pressure and mass continuity across segment junctions. </p>

<p>The 1D network model show in Fig. 1 comprises </p>

<ul>
  <li> 1 inlet </li>
  <li> 10 nodes </li>
  <li> 4 joints </li>
  <li> 9 segments </li>
  <li> 5 outlets </li>
</ul>

<p>These components are labeled in Fig. 2. </p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/solver/images/labeled-1d-network-model.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
 <figcaption> <i>Figure 2. A 1D network model comprising 10 nodes, 4 joints and 9 segments. Node IDs are in parentheses</i></figcaption>
</figure>
<br></p>

<p>Joint1 defines a constraint betreen segments 1, 2 and 4 at node2, joint2 between segments 2, and 7 at node3, etc.</p>

<h3> Finite Element Mesh </h3>

<p>Each segment is discretized into a number of finite elements in order to numerically solve the 1D equations of fluid flow in
deformable vessels (Fig. 3). This yields a 1D finite element mesh.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/images/segment-elements.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
 <figcaption> <i> Figure 3. A segment is discretized into a mesh n of finite elements. </i> </figcaption>
</figure>
<br></p>

<p>The number of elements needed to simulation wave propagation in a segment depends on the material model and boundary conditions used 
in a 1D simulation. 
The number of elements required to achieve reliable results should be determined using a mesh convergence study, where several meshes 
are generated with different number of elements per segment until the simulation results do not substantially change. In general 10-25 
elements per segment is sufficient. If you have very large segements you will likely want to increase this to 50-150 elements per segment. 
You can start at the smaller number of elements per segment and increase if you experience solver errors (see below).</p>

<p>The number element quadrature points determines the accuracy of the numerical integration used to approximates integrals in 
the element formulation. This number generally does not need to be changed and can remain at its default value of 4.</p>

<h3> Time Step </h3>

<p>The size of your time step is influenced by several factors. For a straight, smooth, well-behaved model, a larger time step can be used. 
Additionally, for more stiff vessels (higher elastic modulus), a larger time step can be used. The more compliance is present in your model 
or the presence of a larger number of branches or very small branches will likely necessitate smaller time steps. Starting with a time 
step of 0.01 and decreaing by a factor of &frac12; until your model attains convergence. </p>

<h3> Solver Errors </h3>

<p>If you receive an error while running a simulation, most commonly this can be solved by decreasing the time step 
(work in factors of &frac12;) and increasing the number of elements per segment (work in factors of 2).</p>

<p>A common error, which can occur when there is a large difference in the inlet and outlet areas of a segment, is <strong>outlet areas going negative</strong>.</p>

<p>If this isn&rsquo;t working, then the geometry of the 1D model may need to be altered. This could involve adding additional segments to make the 
change in inlet and outlet area of the segments more gradual. It could also included truncating the model to remove branches or sections of 
branches with very small radii.</p>

<h3> Simlation Results </h3>

<p>The 1D solver writes simulation results for cross-section area, flow, pressure, Reynolds number (Re), and wall shear stress (WSS) for
each segment in your model. Results files are named using the following convention</p>

<pre>
MODEL_SEGMENT_DATA.dat

  where 

    MODEL - Model name
    SEGMENT - Segement name
    DATA - Data name: area, flow, pressure, Re, wss

  Example: 

    demoGroup0_Seg0_wss.dat

</pre>

<p>Each row in the .dat file contains simulation results for each segement finite element for each output simulation time as 
set by the solver input file <strong>SOLVEROPTIONS</strong> statement. There are N+1 rows for a segment divided into into N elements.
The last row contains results for the segment outlet.</p>
</section>
  <section id="solver-input-file" class="subgroup"><h1>Input File Format</h1>

<p>The 1D Solver executes using a single input text file. The 1D Solver reads in the input text file and 
executes keyword statements to define data for</p>

<ol>
  <li>Finite element mesh</li>
  <li>Boundary conditions</li>
  <li>Material model</li>
  <li>Solver parameters </li>
</ol>

<p>The general format for a keyword statement is a capitalized name followed by list of data values
<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #000000;">
  KEYWORD <i>value$_1$</i> <i>value$_2$</i> &hellip; <i>value$_N$</i>
</div>
<br></p>

<p>The following keywords are used by the 1D Solver to define and execute a 1D simulation</p>

<ol>
  <li> <a href="#format_data_table"> DATATABLE / ENDDATATABLE </a> </li>
  <li> <a href="#format_include"> INCLUDE </a> </li>
  <li> <a href="#format_joint"> JOINT </a> </li>
  <li> <a href="#format_joint_inlet"> JOINTINLET </a> </li>
  <li> <a href="#format_joint_outlet"> JOINTOUTLET </a> </li>
  <li> <a href="#format_material"> MATERIAL </a> </li>
  <li> <a href="#format_model"> MODEL </a> </li>
  <li> <a href="#format_node"> NODE </a> </li>
  <li> <a href="#format_output"> OUTPUT </a> </li>
  <li> <a href="#format_segment"> SEGMENT </a> </li>
  <li> <a href="#format_solver_options"> SOLVEROPTIONS </a> </li>
</ol>

<!-- DATATABLE --> 

<p><br>
<a id="format_data_table"> <h3> DATATABLE / ENDDATATABLE </h3></a> 
The DATATABLE statement is used to specify constant and time-varying quantities for inlet/outlet boundary conditions 
as a list of List of time/value pairs.
It also computes admittance and impedance from a parametric definition of the downstream vessel morphometry. </p>

<p>Format
<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #000000;">
  DATATABLE <i>name</i>  <i>type</i> 
  <ul style="list-style-type:none;">
  <li><i>$row_1$</i></li>
  <li><i>$row_2$</i></li>
  <li><i>&hellip;</i></li>
  <li><i>$row_N$</i></li>
  </ul>
  ENDDATATABLE
  <br>
  <br></p>

<p>Arguments
  <ul style="list-style-type:none;">
    <li><i>name</i> (string)) - Data table name </li><br>
    <li><i>type</i> (string) - Data table type. 
  </ul>
  <br></p>

<p>Data table type
  <ul style="list-style-type:none;">
    <li>LIST - Table values are specified by alternating the time and the quantity of interest at that instant in time. 
      <ul style="list-style-type:none;">
      <li>$row_1$</i> = <i>time$_1$ value$_1$</i></li>
      <li><i>$row_2$</i> = time$_2$ value$_2$</i></li>
      <li><i>&hellip;</i></li>
      <li><i>$row_N$</i> = time$_N$ value$_N$</i></li>
      </ul>
   </li><br>
  </ul></p>

<p></div></p>

<p><br>
Example: Set a constant inlet flow rate of 14.0.</p>
<pre class="highlight plaintext"><code>  DATATABLE INLETDATA LIST
  0.0 14.0 
  10.0 14.0
  ENDDATATABLE
</code></pre>

<p><br>
Example: Set a time-varying inlet flow rate. </p>
<pre class="highlight plaintext"><code>  DATATABLE INLETDATA LIST
  0.0 14.0 
  1.0 20.0
  2.0 50.0
  2.5 89.2
  3.5 110.0
  5.0 70.0
  6.0 48.0
  7.0 20.0
  8.0 14.0
  ENDDATATABLE
</code></pre>

<p><br></p>

<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid green; border-left: 6px solid green">
When entering values for PRESSURE, RESISTANCE, RCR, etc. a time value must be given even if its value will not be read. 
</div>

<p><br></p>

<p>Example: Set outlet resistance value of 1000.0 Barye s/mL.</p>
<pre class="highlight plaintext"><code>  DATATABLE RTABLE LIST
  0.0 1000.0 
  ENDDATATABLE
</code></pre>

<!-- INCLUDE -->

<p><br>
<a id="format_include"> <h3> INCLUDE </h3></a> 
The INCLUDE statement is used to recursively include input files in the project. </p>

<p>Format
<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #000000;">
  INCLUDE <i>name</i>  <i>activate</i></p>

<p>Arguments
  <ul style="list-style-type:none;">
    <li><i>name</i> (string, no spaces) -  Name of the file to include </li><br>
    <li><i>activate</i> (boolean) -  Activate file. 
       If set to TRUE then the file is included in the current model. If set to FALSE then the file is not used. 
    </li><br> 
  </ul>
</div></p>

<p>Example: Include the file named <em>auxFile.in</em> in the current model.</p>
<pre class="highlight plaintext"><code>  INCLUDE auxFile.in TRUE
</code></pre>

<!-- JOINT -->

<p><br>
<a id="format_joint"> <h3> JOINT </h3></a> 
The JOINT statement is used to specify a connection between vessel segments. By entering the inlet and outlet vessel segments is it possible to enforce a unique value of pressure in the junction and a flow rate that satisfy conservation of mass. </p>

<p>Format</p>

<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #000000;">
  JOINT <i>name</i>  <i>node</i> <i>inlet</i> <i>outlet</i>
  <br>
  <br>

  Arguments
  <ul style="list-style-type:none;">
    <li><i>name</i> (string) -  Joint name </li><br>
    <li><i>node</i> (integer) -  Joint node ID </li><br>
    <li><i>inlet</i> (string) - Joint inlet name </li><br>
    <li><i>outlet</i> (string) - Joint outlet name </li><br>
  </ul>
</div>

<p><br></p>

<p>Example: Define a joint named <em>JOINT1</em> at node <em>1</em> connecting inlet <em>IN0</em> to outlet <em>OUT0</em>. </p>
<pre class="highlight plaintext"><code>  JOINT JOINT1 1 IN0 OUT0
</code></pre>

<!-- JOINTINLET -->

<p><br>
<a id="format_joint_inlet"> <h3> JOINTINLET </h3></a> 
The JOINTINLET statement is used to specify a list of segments IDs as inlets for a joint entity. </p>

<p>Format
<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #000000;">
  JOINTINLET <i>name</i>  <i>nsegs</i>  <i>list</i>
  <br>
  <br></p>

<p>Arguments
  <ul style="list-style-type:none;">
    <li><i>name</i> (string) - Inlet name </li><br>
    <li><i>nsegs</i> (integer) - Total number of segments </li><br>
    <li><i>list</i> (list of integers) - List of segment IDs </li><br>
  </ul>
<br>
</div>
<br></p>

<p>Example: Define a inlet joint named <em>IN0</em> with segment ID equal to 2, 4, and 5.</p>
<pre class="highlight plaintext"><code>  JOINTINLET IN0 3 2 4 5
</code></pre>

<!-- JOINTOUTLET -->

<p><br>
<a id="format_joint_outlet"> <h3> JOINTOUTLET </h3></a> 
The JOINTOUTLET statement is used to specify a list of segment IDs as outlets for a joint entity. </p>

<p>Format</p>

<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #000000;">
  JOINTOUTLET <i>name</i>
  <br> <br>

  Arguments
  <ul style="list-style-type:none;">
    <li><i>name</i> (string) - Outlet name </li><br>
    <li><i>nsegs</i> (integer) - Total number of segments </li><br>
    <li><i>list</i> (list of integers) - List of segment IDs </li><br>
  </ul>
<br>
</div>

<p><br></p>

<p>Example: Define an outlet joint named <em>OUT0</em> with 3 inlets and segment IDs 2, 4, and 5. </p>
<pre class="highlight plaintext"><code>  JOINTOUTLET OUT0 3 2 4 5
</code></pre>

<!-- MATERIAL -->

<p><br>
<a id="format_material"> <h3> MATERIAL </h3></a> 
The MATERIAL statement is used to specify a constitutive relationship between pressure, cross section diameter and thickness. </p>

<p>Format</p>

<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #000000;">
  MATERIAL <i>name</i> 
    <i>type</i>
    <i>density</i>
    <i>viscosity</i>
    <i>exponent</i>
    <i>$k_1$</i> [ <i>$k_2$</i> <i>$k_3$</i> ]
  <br> <br>

  Arguments
  <ul style="list-style-type:none;">
    <li><i>name</i> (string) - Material name. </li><br>
    <li><i>type</i> (string) - Material type. </li><br>
    <li><i>density</i> (double) - Material density.  </li><br>
    <li><i>viscosity</i> (double) - Material viscosity.  </li><br>
    <li><i>pressure</i> (double) - Material reference pressure.  </li><br>
    <li><i>exponent</i> (double) - Material exponent.  </li><br>
    <li><i>$k_1$</i> (double) - Material $k_1$ parameter.  </li><br>
    <li><i>$k_2$</i> (double) - Material $k_2$ parameter. Optional, used for OLUFSEN material. </li><br>
    <li><i>$k_3$</i> (double) - Material $k_3$ parameter. Optional, used for OLUFSEN material. </li><br>
  </ul>

  Material types
  <ul style="list-style-type:none;">
    <li>LINEAR - Linear material. </li><br>
    <li>OLUFSEN - Olufsen material. </li><br>
  </ul>

</div>

<p><br></p>

<p>Example: Linear material</p>
<pre class="highlight plaintext"><code>  MATERIAL MAT1 LINEAR  1.06 0.04 120000.0 1.0 7.1e4
</code></pre>

<p><br></p>

<p>Example: Olufsen material</p>
<pre class="highlight plaintext"><code>  MATERIAL MAT1 OLUFSEN 1.06 0.04 120000.0 1.0 2.0e7 -22.5267 8.65e5
</code></pre>

<p><br>
<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid green; border-left: 6px solid green">
The reference pressure is the pressure associated with the undeformed area of the vessel. Typically this is the diastolic pressure for a specific vessel. Multiple reference pressures can be assigned to segments using multiple material models.
</div></p>

<p><br>
<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid green; border-left: 6px solid green">
For the OLUFSEN material model, all three parameters need to be defined, i.e., $k_1$, $k_2$,$k_3$. For a LINEAR material 
model instead only the first material parameter $k_1$ is used and set equal to $E\,h/r$, i.e., the product of elastic modulus and 
thickness divided by the radius.
</div></p>

<!-- MODEL -->

<p><br>
<a id="format_model"> <h3> MODEL </h3></a> 
The MODEL statement is used to define a name for the model that is used when generating the output files. </p>

<p>Format
<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #000000;">
  MODEL <i>name</i> </p>

<p>Arguments
  <ul style="list-style-type:none;">
    <li><i>name</i> (string) - Model name. </li><br>
  </ul>
</div>
<br></p>

<p>Example: Define a model named <em>Artery</em>.</p>
<pre class="highlight plaintext"><code>  MODEL Artery
</code></pre>

<!-- NODE -->

<p><br>
<a id="format_node"> <h3> NODE </h3></a> 
The NODE statement is used to specify the coordinates of a connection between vessel segments. </p>

<p>Format
<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #000000;">
  NODE <i>id</i> <i>x</i>  <i>y</i>  <i>z</i>
  <br></p>

<p>Arguments
  <ul style="list-style-type:none;">
    <li><i>id</i> (integer) - Node ID. </li><br>
    <li><i>x</i> (double) - Node X coordinate. </li><br>
    <li><i>y</i> (double) - Node Y coordinate. </li><br>
    <li><i>z</i> (double) - Node Z coordinate. </li><br>
  </ul>
</div>
<br></p>

<p>Example: Define a node with ID <em>1</em> and coordinates <em>1.0 2.0 3.0</em>.</p>
<pre class="highlight plaintext"><code>  NODE 0 1.0 2.0 3.0
</code></pre>

<!-- OUTPUT -->

<p><br>
<a id="format_output"> <h3> OUTPUT </h3></a> 
The OUTPUT statement specifies the file formats for the program outputs. </p>

<p>Format
<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #000000;">
  OUTPUT <i>format</i> [ <i>option</i> ]</p>

<p>Arguments
  <ul style="list-style-type:none;">
    <li><i>format</i> (string) - Output file format. </li><br>
    <li><i>option</i> (integer) - VTK export option. </li><br>
  </ul></p>

<p>Output formats
  <ul style="list-style-type:none;">
    <li>TEXT  - Writes each segment in a separate text file for the flow rate, pressure, area and Reynolds number.  The rows contain output values at varying locations along the segment while columns contains results at various time instants.  </li><br>
    <li>VTK  - Results for all time steps are plotted to a 3D-like model using the XML VTK file format. </li><br>
    <li>BOTH -  Write both TEXT and VTK results. </li><br>
  </ul></p>

<p>VTK export options
  <ul style="list-style-type:none;">
    <li>0 - Output multiple files (default). A separate file is written for each saved increment. A <strong>pvd</strong> file is also provided which contains the time information of the sequence. This is the best option to create animations. </li><br>
    <li>1 - The results for all time steps are plotted to a single XML VTK file. </li><br>
  </ul></p>

<p></div>
<br></p>

<p>Example: Write results in VTK format to multiple files.</p>
<pre class="highlight plaintext"><code>  OUTPUT VTK 0
</code></pre>

<!-- SEGMENT -->

<p><br>
<a id="format_segment"> <h3> SEGMENT </h3></a> 
The SEGMENT statement is used to define a vessel segment. </p>

<p>Format
<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #000000;">
  SEGMENT <i>name</i> 
    <i>id</i>
    <i>length</i>
    <i>nelems</i>
    <i>inode</i>
    <i>onode</i>
    <i>iarea</i>
    <i>oarea</i>
    <i>iflow</i>
    <i>material</i>
    <i>mltype</i>
    <i>angle</i>
    <i>uid</i>
    <i>bid</i>
    <i>bctype</i>
    <i>dname</i>
  <br>
  <br></p>

<p>Arguments
  <ul style="list-style-type:none;">
    <li><i>name</i> (string) -  Segment name. </li><br>
    <li><i>id</i> (integer) - Segment ID. </li><br>
    <li><i>length</i> (double - Segment length. </li><br>
    <li><i>nelems</i> (integer) - Total finite elements in segment. </li><br>
    <li><i>inode</i> (integer) - Segment inlet <strong>Node</strong>. </li><br>
    <li><i>onode</i> (integer) - Segment outlet <strong>Node</strong>. </li><br>
    <li><i>iarea</i> (double - Segment inlet area. </li><br>
    <li><i>oarea</i> (double - Segment outlet area. </li><br>
    <li><i>iflow</i> (double - Segment initial flow. </li><br>
    <li><i>material</i> (string) - Segment material. </li><br>
    <li><i>mltype</i> (string) - Minor loss type. </li><br>
    <li><i>angle</i> (double) - Branch angle. </li><br>
    <li><i>uid</i> (integer) - Upstream segment ID. </li><br>
    <li><i>bid</i> (integer) - Branch segment ID. </li><br>
    <li><i>bctype</i> (string) - Boundary condition type. </li><br>
    <li><i>dname</i> (string) - Data Table Name for boundary condition. </li><br>
  </ul></p>

<p>Minor loss types
  <ul style="list-style-type:none;">
    <li>NONE - No pressure loss. </li><br>
  </ul></p>

<p>Boundary condition types
  <ul style="list-style-type:none;">
    <li> FLOW - Time-varying outlet flow rate. </li><br>
    <li> NOBOUND - No outlet boundary condition. </li><br>
    <li> PRESSURE -  Constant pressure in the model units. </li><br>
    <li> RCR - Boundary condition specified through an RCR circuit. </li><br>
    <li> RESISTANCE - Constant resistance in model units. </li><br>
    <li> RESISTANCE_TIME -  Time-varying resistance in model units. </li><br>
  </ul>
</div>
<br></p>

<p>Example  </p>
<pre class="highlight plaintext"><code>  SEGMENT ARTERY 0 40.0 15 0 1 2.8 2.1 0.0 MAT1 NONE 0.0 0 0 FLOW INLETDATA
</code></pre>

<!-- SOLVEROPTIONS -->

<p><br>
<a id="format_solver_options"> <h3> SOLVEROPTIONS </h3></a> 
The SOLVEROPTIONS statement specifies options needed by the finite element solver. </p>

<p>Format
<div style="background-color: #F0F0F0; padding: 10px; border: 1px solid #000000;">
  SOLVEROPTIONS <i>timestep</i> 
    <i>savefreq</i>
    <i>maxsteps</i>
    <i>nquad</i>
    <i>dname</i>
    <i>bctype</i>
    <i>tol</i>
    <i>form</i>
    <i>stab</i></p>

<p>Arguments
  <ul style="list-style-type:none;">
    <li><i> timestep </i> (double) - Solver time step. </li><br>
    <li><i> savefreq </i> (integer) - Number of steps between saving results. </li><br>
    <li><i> maxsteps </i> (integer) - Maximum number of time steps. </li><br>
    <li><i> nquad </i> (integer) - Number of quadrature points for finite elements. </li><br>
    <li><i> dname </i> (string) - Name of data table for inlet boundary conditions. </li><br>
    <li><i> bctype </i> (string) - Boundary condition type. </li><br>
    <li><i> tol </i> (double) - Convergence tolerance. </li><br>
    <li><i> form </i> (string) - Formulation type. </li><br>
    <li><i> stab </i> (string) - Stabilization. </li><br>
  </ul></p>

<p>Boundary condition types
  <ul style="list-style-type:none;">
    <li> FLOW - Time-varying outlet flow rate. </li><br>
    <li> NOBOUND - No outlet boundary condition. </li><br>
    <li> PRESSURE -  Constant pressure in the model units. </li><br>
    <li> RCR - Boundary condition specified through an RCR circuit. </li><br>
    <li> RESISTANCE - Constant resistance in model units. </li><br>
    <li> RESISTANCE_TIME -  Time-varying resistance in model units. </li><br>
  </ul></p>

<p>Formulation types 
  <ul style="list-style-type:none;">
    <li> 0 - Advective formulation. </li><br>
    <li> 1 - Conservative formulation. </li><br>
  </ul></p>

<p>Stabilization options 
  <ul style="list-style-type:none;">
    <li> 0 - No stabilization. </li><br>
    <li> 1 - Use stabilization. </li><br>
  </ul></p>

<p></div>
<br></p>

<p>Example</p>
<pre class="highlight plaintext"><code>  SOLVEROPTIONS 0.01 10 1000 4 INLETDATA FLOW 1.0e-3 1 1  
</code></pre>
</section>
  <section id="solver-tutorial-simple-artery" class="subgroup"><h1> Tutorial - Simple Artery </h1>

<p>This tutorial demonstrates how to create a 1D Solver input file for a model of a single vessel with different outflow boundary conditions. </p>

<p>In the following sections the contents of the 1D Solver input file are shown as shaded blocks. Text preceding each block
describe its contents.</p>

<h2> Outlet Flow </h2>

<p>Create a 1D Simulation input file for a FLOW outlet boundary condition. 
Since the model contains a single vessel there is only one segment and thus no <strong>JOINTS</strong> need be defined.</p>

<p>The complete 1D Simulation input file listing is 
<a href="documentation/1d_simulation/solver/files/01_simpleArtery_Flow.in"> here </a>.</p>

<h3> 1D Solver input file </h3>

<p>Set the model name to be <strong>simpleArtery_Flow_</strong>.</p>
<pre class="highlight plaintext"><code> MODEL simpleArtery_Flow_
</code></pre>

<p><br>
Create two nodes defining the ends of the vessel.</p>
<pre class="highlight plaintext"><code>  NODE 0 0.0 0.0 0.0
  NODE 1 0.0 0.0 -20.0
</code></pre>

<p><br>
Create a segment with the following properties
<p style="font-size:11px">
<i>
ID = 0,
length = 20.0,
number of finite elements in segment = 50,
segment inlet node = 0,
segment outlet node = 1,
segment inlet area = 2.0,
segment outlet area = 2.0,
segment initial flow = 14,
segment material = MAT1,
minor loss type = NON,
branch angle = 0.0,
upstream segment ID = 0,
branch segment ID = 0,
boundary condition type = FLOW,
data table name for boundary condition = OUTLETDATA 
</i>
</p></p>
<pre class="highlight plaintext"><code>SEGMENT ARTERY 0 20.0 50 0 1 2.0 2.0 14.0 MAT1 NONE 0.0 0 0 FLOW OUTLETDATA
</code></pre>

<p><br>
Create a data table for an inlet flow boundary condition.</p>

<div style="height:120px;overflow:auto;">
<pre>
  DATATABLE INLETDATA LIST
  0.0 24.9485671447
  0.00401706131058 25.038543576
  0.00804158927788 25.1253750951
  0.0120586505885 25.3133340807
  0.0160831785558 25.7172792237
  0.0201002398663 26.4516350474
  0.0241173011769 27.6195531882
  0.0281418291442 29.3038021034
  0.0321588904548 31.5606599331
  0.0361834184221 34.4176116259
  0.0402004797327 37.8750455157
  0.0442175410433 41.9115017555
  0.0482420690106 46.4914673291
  0.0522591303212 51.5743145829
  0.0562836582885 57.1228256834
  0.060300719599 63.1098514231
  0.0643252475663 69.5220015042
  0.0683423088769 76.3597981496
  0.0723593701875 83.6343477651
  0.0763838981548 91.3611943552
  0.0804009594654 99.5525021976
  0.0844254874327 108.208997219
  0.0884425487433 117.313126431
  0.0924596100539 126.824666809
  0.0964841380211 136.679580202
  0.100501199332 146.792340186
  0.104525727299 157.061354108
  0.10854278861 167.376580507
  0.11255984992 177.628083291
  0.116584377887 187.714136939
  0.120601439198 197.547616689
  0.124625967165 207.059750772
  0.128643028476 216.200813465
  0.132660089787 224.937897126
  0.136684617754 233.250429224
  0.140701679064 241.12448159
  0.144726207032 248.547101058
  0.148743268342 255.501829545
  0.152760329653 261.966302945
  0.15678485762 267.91235955
  0.160801918931 273.308561533
  0.164826446898 278.124512738
  0.168843508209 282.335962851
  0.172860569519 285.929487871
  0.176885097487 288.90557465
  0.180902158797 291.279208303
  0.184926686764 293.077520075
  0.188943748075 294.334618627
  0.192968276042 295.084290955
  0.196985337353 295.351725893
  0.201002398663 295.145680584
  0.205026926631 294.452540193
  0.209043987941 293.233485586
  0.213068515909 291.425532597
  0.217085577219 288.946601564
  0.22110263853 285.70412707
  0.225127166497 281.606131294
  0.229144227808 276.573264115
  0.233168755775 270.550125543
  0.237185817086 263.51427286
  0.241202878396 255.481650163
  0.245227406363 246.507714017
  0.249244467674 236.684172337
  0.253268995641 226.131893546
  0.257286056952 214.991082946
  0.261303118263 203.410169094
  0.26532764623 191.534949707
  0.26934470754 179.499405635
  0.273369235508 167.41923233
  0.277386296818 155.388639562
  0.281403358129 143.480410496
  0.285427886096 131.748704658
  0.289444947407 120.233702756
  0.293469475374 108.966999282
  0.297486536685 97.9766585376
  0.301503597995 87.2910578797
  0.305528125962 76.9409855029
  0.309545187273 66.9598753462
  0.31356971524 57.3824574617
  0.317586776551 48.2424082888
  0.321611304518 39.569743891
  0.325628365829 31.3886895826
  0.329645427139 23.7165911301
  0.333669955107 16.5641438274
  0.337687016417 9.93688018295
  0.341711544385 3.83753834884
  0.345728605695 -1.73129722655
  0.349745667006 -6.76498144367
  0.353770194973 -11.2556542907
  0.357787256284 -15.1925670479
  0.361811784251 -18.5639944198
  0.365828845562 -21.3604787071
  0.369845906872 -23.5788280531
  0.373870434839 -25.2260660795
  0.37788749615 -26.3224530944
  0.381912024117 -26.9027993353
  0.385929085428 -27.015546634
  0.389946146738 -26.719474801
  0.393970674706 -26.0783193949
  0.397987736016 -25.1539952306
  0.402012263984 -23.9994270173
  0.406029325294 -22.6521354593
  0.410046386605 -21.1296839164
  0.414070914572 -19.4278520119
  0.418087975883 -17.5220123013
  0.42211250385 -15.3716976869
  0.426129565161 -12.9278448545
  0.430146626471 -10.1417648421
  0.434171154438 -6.97459768401
  0.438188215749 -3.40590409029
  0.442212743716 0.559852321251
  0.446229805027 4.88988390883
  0.450254332994 9.52323419211
  0.454271394305 14.3745124875
  0.458288455615 19.3407053071
  0.462312983583 24.3101412797
  0.466330044893 29.1724063508
  0.470354572861 33.8279151858
  0.474371634171 38.1959388674
  0.478388695482 42.2201524963
  0.482413223449 45.871148806
  0.48643028476 49.1458023291
  0.490454812727 52.0637949468
  0.494471874038 54.6619653254
  0.498488935348 56.9873751098
  0.502513463315 59.0900727083
  0.506530524626 61.0164764312
  0.510555052593 62.8041192052
  0.514572113904 64.4782349571
  0.518589175214 66.0503675931
  0.522613703182 67.5188969255
  0.526630764492 68.8711433057
  0.53065529246 70.0865579991
  0.53467235377 71.1404415244
  0.538689415081 72.0076559733
  0.542713943048 72.6658851088
  0.546731004359 73.0981315905
  0.550755532326 73.2942889218
  0.554772593637 73.2517649691
  0.558789654947 72.9752495544
  0.562814182914 72.4757923237
  0.566831244225 71.7693993197
  0.570855772192 70.8753586268
  0.574872833503 69.8144948133
  0.57889736147 68.6075179102
  0.582914422781 67.2736004464
  0.586931484091 65.8292837429
  0.590956012059 64.2877808751
  0.594973073369 62.6587139871
  0.598997601337 60.9482898474
  0.603014662647 59.1598805908
  0.607031723958 57.2949382563
  0.611056251925 55.3541315489
  0.615073313236 53.3385658404
  0.619097841203 51.2509277089
  0.623114902513 49.0964028105
  0.627131963824 46.8832462501
  0.631156491791 44.6229340634
  0.635173553102 42.3298944201
  0.639198081069 40.0208905863
  0.64321514238 37.7141850892
  0.64723220369 35.4286569387
  0.651256731658 33.1830441259
  0.655273792968 30.9954505668
  0.659298320936 28.8831861021
  0.663315382246 26.8629219606
  0.667332443557 24.9510496484
  0.671356971524 23.1640581717
  0.675374032835 21.5187111666
  0.679398560802 20.0318203252
  0.683415622113 18.719482153
  0.687432683423 17.5957616712
  0.69145721139 16.6709456543
  0.695474272701 15.9496274427
  0.699498800668 15.4289872173
  0.703515861979 15.0976749611
  0.707540389946 14.9356617551
  0.711557451257 14.9153075579
  0.715574512567 15.0036963016
  0.719599040535 15.1660610822
  0.723616101845 15.3698862953
  0.727640629812 15.5890888464
  0.731657691123 15.8075811185
  0.735674752434 16.0215392172
  0.739699280401 16.2398440817
  0.743716341712 16.4824250012
  0.747740869679 16.7765754424
  0.751757930989 17.1516703569
  0.7557749923 17.6330420974
  0.759799520267 18.2359914278
  0.763816581578 18.9609858486
  0.767841109545 19.7909909825
  0.771858170856 20.6916127038
  0.775875232166 21.6143095508
  0.779899760134 22.502454957
  0.783916821444 23.2995386527
  0.787941349412 23.9584014928
  0.791958410722 24.4501547304
  0.795975472033 24.7714012308
  0.8 24.9485671447
  ENDDATATABLE
</pre>
</div>

<p><br>
Create a data table for an outlet flow boundary condition.</p>
<pre class="highlight plaintext"><code>  DATATABLE OUTLETDATA LIST
  0.0 20.0
  10.0 20.0
  ENDDATATABLE
</code></pre>

<p><br>
Create a material named <strong>MAT1</strong> for an OLUFSEN consitutive model with the following parameters
<p style="font-size:11px">
<i>
name = MAT1,
type = OLUFSEN,
density =  1.06,
viscosity = 0.04,
pressure = 113324.0,
exponent = 1.0,
$k_1$ = 2.0e7,
$k_2$ = -22.5267,
$k_3$ = 8.65e5 
</i>
</p></p>
<pre class="highlight plaintext"><code>  MATERIAL MAT1 OLUFSEN 1.06 0.04 113324.0 1.0 2.0e7 -22.5267 8.65e5
</code></pre>

<p><br>
Set the solver following solver options
<p style="font-size:11px">
<i>
time step = 0.01, 
save results frequency = 1,
number of time steps = 400, 
number of finite element quadrature points = 2,
inlet boundary conditions data table name = INLETDATA, 
inlet boundary condition type = FLOW,
convergence tolerance = 1.0e-4, 
formulation type = 1 (conservative formulation),
stabilization = 1 (use stabilization) 
</i>
</p></p>
<pre class="highlight plaintext"><code>SOLVEROPTIONS 0.01 1 400 2 INLETDATA FLOW 1.0e-4 1 1 
</code></pre>

<p><br>
Set results to be written for each segment in a separate text file for the flow rate, pressure, area and Reynolds number.</p>
<pre class="highlight plaintext"><code>OUTPUT TEXT
</code></pre>

<p><br>
<h3> Results </h3>
The results of the simulation are shown using the following graphs.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/solver/images/Ex01-plottingExample_01.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <img src="documentation/1d_simulation/solver/images/Ex01-plottingExample_03.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<!--  Outlet Resistance  -->

<p><br>
<h2> Outlet Resistance </h2>
Create a 1D Simulation input file for a constant resistance outlet boundary condition. </p>

<p>The complete 1D Simulation input file listing is 
<a href="documentation/1d_simulation/solver/files/02_simpleArtery_Resistance.in"> here </a>.</p>

<h3> 1D Solver input file </h3>

<p>The MODEL and SEGMENT statements need to be modified and the OUTLETDATA data table replaced with outlet resistance data. 
All the other statements are the same as those in the <strong>Outlet Flow</strong> input.</p>

<p><br>
Set the model name to be <strong>simpleArtery_Res_</strong>.</p>
<pre class="highlight plaintext"><code> MODEL simpleArtery_Res_
</code></pre>

<p><br>
Create a segment using a RESISTANCE boundary condition </p>
<pre class="highlight plaintext"><code>SEGMENT ARTERY 0 20.0 50 0 1 2.0 2.0 14.0 MAT1 NONE 0.0 0 0 RESISTANCE OUTLETDATA
</code></pre>

<p><br>
Create a data table for the outlet resistance boundary condition.</p>
<pre class="highlight plaintext"><code>  DATATABLE OUTLETDATA LIST
  0.0 100.0
  ENDDATATABLE
</code></pre>

<p><br>
<h3> Results </h3>
The results of the simulation are shown using the following graphs.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/solver/images/Ex02-plottingExample_01.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <img src="documentation/1d_simulation/solver/images/Ex02-plottingExample_03.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<!--  Outlet Pressure -->

<p><br>
<h2> Outlet Pressure </h2>
Create a 1D Simulation input file for a constant pressure outlet boundary condition. </p>

<p>The complete 1D Simulation input file listing is 
<a href="documentation/1d_simulation/solver/files/04_simpleArtery_Pressure.in"> here </a>.</p>

<h3> 1D Solver input file </h3>

<p>The MODEL and SEGMENT statements need to be modified and the OUTLETDATA data table replaced with outlet pressure data. 
All the other statements are the same as those in the <strong>Outlet Flow</strong> input.</p>

<p><br>
Set the model name to be <strong>simpleArtery_Pres_</strong>.</p>
<pre class="highlight plaintext"><code> MODEL simpleArtery_Pres_
</code></pre>

<p><br>
Create a segment using a PRESSURE boundary condition</p>
<pre class="highlight plaintext"><code>SEGMENT ARTERY 0 20.0 50 0 1 2.0 2.0 14.0 MAT1 NONE 0.0 0 0 PRESSURE OUTLETDATA
</code></pre>

<p><br>
Create a data table for the outlet pressure boundary condition.</p>
<pre class="highlight plaintext"><code>  DATATABLE OUTLETDATA LIST
  0.0 100.0
  ENDDATATABLE
</code></pre>

<p><br>
<h3> Results </h3>
The results of the simulation are shown using the following graph.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/solver/images/Ex04-plottingExample_01.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <img src="documentation/1d_simulation/solver/images/Ex04-plottingExample_03.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>
</section>
  <section id="solver-tutorial-aorta-iliac" class="subgroup"><h1> Tutorial - Aorta and Iliac Arteries </h1>

<p>This tutorial demonstrates how to create a 1D Solver input file for a model of an abdominal aorta with branching 
right and left iliac arteries. </p>

<p>In the following sections the contents of the 1D Solver input file are shown as shaded blocks. Text preceding each block
describe its contents.</p>

<h2> Outlet RCR </h2>

<p>Create a 1D Simulation input file for a constant RCR resistance outlet boundary condition. </p>

<p>The complete 1D Simulation input file listing is 
<a href="documentation/1d_simulation/solver/files/05_bifurcation_RCR.in"> here </a>.</p>

<h3> 1D Solver input file </h3>

<p>Set the model name to be <strong>Bifurcation_RCR_</strong>.</p>
<pre class="highlight plaintext"><code> MODEL Bifurcation_RCR_ 
</code></pre>

<p><br>
Create four nodes defining the model inlets, outlets and the location of the branching right and left iliac arteries.</p>
<pre class="highlight plaintext"><code>NODE 0 0.0 0.0 0.0
NODE 1 0.0 0.0 -17.670671
NODE 2 0.0 6.498730 -40.182934
NODE 3 4.595296 4.595296 -40.182934
</code></pre>

<p><br>
Create a single joint at the location of the branching right and left iliac arteries. </p>
<pre class="highlight plaintext"><code>JOINT AbdomBifurcJ 1 INSEGS OUTSEGS
JOINTINLET INSEGS 1 0
JOINTOUTLET OUTSEGS 2 1 2
</code></pre>

<p><br>
Create three segments representing the aorta, right iliac, and left iliac arteries. </p>
<pre class="highlight plaintext"><code>SEGMENT Aorta  0 17.670671 50 0 1 5.027254990390394 1.6068894493599328 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT iliacR 1 12.997461 50 1 3 1.55              0.3525652531134944 0.0 MAT1 NONE 0.0 0 0 RCR RCR_VALS
SEGMENT iliacL 2 12.997461 50 1 2 1.55              0.3525652531134944 0.0 MAT1 NONE 0.0 0 0 RCR RCR_VALS_2
</code></pre>

<p><br>
Create a data table for the aorta inlet flow boundary condition.</p>

<div style="height:120px;overflow:auto;">
<pre>
DATATABLE AORTAFLOW LIST
0 34.8
0.01406 35.75183
0.02813 36.62183
0.04219 36.85225
0.05625 38.93465
0.07031 41.76
0.08438 45.97649
0.09844 50.73564
0.1125 55.24931
0.12656 60.63297
0.14062 66.01663
0.15469 70.51522
0.16845 74.55297
0.18281 76.94763
0.19687 80.61282
0.21094 81.08874
0.225 81.12535
0.23906 80.64943
0.25312 79.30352
0.26719 75.5328
0.28125 70.67673
0.29531 65.27154
0.30938 59.03941
0.32344 52.64361
0.3375 44.90406
0.35156 42.0421
0.36563 38.18094
0.37969 31.45136
0.39375 28.71
0.40781 28.71
0.42188 26.97
0.43594 26.13661
0.45 26.97
0.46406 27.84
0.47813 28.36114
0.49219 29.96116
0.50625 33.99891
0.52031 35.87889
0.53438 37.2248
0.54844 38.86144
0.5625 41.55327
0.57656 42.13255
0.59063 42.63
0.60469 43.08438
0.61875 43.5
0.63281 43.5
0.64687 42.4878
0.66094 41.76
0.675 41.53604
0.68906 40.19012
0.70312 39.15
0.71719 37.58658
0.73125 36.92762
0.74531 35.68292
0.75938 34.3305
0.77344 33.93
0.7875 33.37871
0.80156 33.2172
0.81563 33.93
0.82969 33.69097
0.84375 33.77495
0.85781 33.38087
0.87188 34.726
0.88594 35.2027
0.9 34.8
ENDDATATABLE
</pre>
</div>

<p><br>
Create a data table for the right iliac outlet flow RCR boundary condition.</p>
<pre class="highlight plaintext"><code>DATATABLE RCR_VALS LIST
0.0 90
0.0 0.0008
0.0 1200
ENDDATATABLE
</code></pre>

<p><br>
Create a data table for the left iliac outlet flow RCR boundary condition.</p>
<pre class="highlight plaintext"><code>DATATABLE RCR_VALS_2 LIST
0.0 100
0.0 0.0004
0.0 1100
ENDDATATABLE
</code></pre>

<p><br>
Create a material named <strong>MAT1</strong> for an OLUFSEN consitutive model with the following parameters
<p style="font-size:11px">
<i>
name = MAT1,
type = OLUFSEN,
density =  1.06,
viscosity = 0.04,
pressure = 113324.0,
exponent = 1.0,
$k_1$ = 2.0e7,
$k_2$ = -22.5267,
$k_3$ = 8.65e5 
</i>
</p></p>
<pre class="highlight plaintext"><code>  MATERIAL MAT1 OLUFSEN 1.06 0.04 113324.0 1.0 2.0e7 -22.5267 8.65e5
</code></pre>

<p><br>
Set the solver following solver options
<p style="font-size:11px">
<i>
time step = 0.001, 
save results frequency = 15,
number of time steps = 10000, 
number of finite element quadrature points = 2,
inlet boundary conditions data table name = AORTAFLOW, 
inlet boundary condition type = FLOW,
convergence tolerance = 1.0e-6, 
formulation type = 1 (conservative formulation),
stabilization = 1 (use stabilization) 
</i>
</p></p>
<pre class="highlight plaintext"><code>SOLVEROPTIONS 0.001 15 10000 2 AORTAFLOW FLOW 1.0e-6 1 1
</code></pre>

<p><br>
Set results to be written for each segment in a separate text file for the flow rate, pressure, area and Reynolds number.</p>
<pre class="highlight plaintext"><code>OUTPUT TEXT
</code></pre>

<p><br>
<h3> Results </h3>
The results of the simulation are shown using the following graphs.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/solver/images/Ex01-plottingExample_01.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <img src="documentation/1d_simulation/solver/images/Ex01-plottingExample_03.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>
</section>
  <section id="solver-tutorial-aorta-femoral" class="subgroup"><h1> Tutorial - Aorta and Femoral Arteries </h1>

<p>This tutorial demonstrates how to create a 1D Solver input file for a model comprising the abdominal aorta, renal, celiac and
femoral arteries. </p>

<p><br>
<figure>
  <img class="svImg svImgMd" src="documentation/1d_simulation/solver/images/aorta-femoral.png">
  <figcaption class="svCaption"> Model geometry showing abdominal aorta, renal, celiac and femoral arteries. </figcaption>
</figure></p>

<p>In the following sections the contents of the 1D Solver input file are shown as shaded blocks. Text preceding each block
describe its contents.</p>

<h2> Outlet RESISTANCE </h2>

<p>Create a 1D Simulation input file for a constant resistance outlet boundary condition. </p>

<p>The complete 1D Simulation input file listing is 
<a href="documentation/1d_simulation/solver/files/12_AortoFem_Pulse_R.in"> here </a>.</p>

<h3> 1D Solver input file </h3>

<p>Set the model name to be <strong>OSMSC0006_Pulse_R_</strong>.</p>
<pre class="highlight plaintext"><code>MODEL OSMSC0006_Pulse_R_
</code></pre>

<p><br>
Create 134 nodes defining the 1D vessel network geometry. 
<div style="height:200px;overflow:auto;">
<pre>
NODE 0 -2.34989197531 -1.39464502469 15.789254321
NODE 1 -2.35514662791 -1.35312902326 15.665327907
NODE 2 -2.37945574468 -1.05999161702 14.3717074468
NODE 3 -2.28650670213 -0.738057542553 12.9622287234
NODE 4 -2.16777270833 -0.423665520833 11.4726916667
NODE 5 -2.11502454545 -0.1567156 10.105156
NODE 6 -1.94930666667 0.114504833333 8.89470555556
NODE 7 -1.87261983696 0.336591065217 7.74440923913
NODE 8 -1.84718395588 0.701716823529 6.564345
NODE 9 -1.831645 1.00149826667 5.42072166667
NODE 10 -1.6918800625 1.44782767188 3.6281084375
NODE 11 -1.65555472222 1.73657694444 2.45095388889
NODE 12 -1.59803769565 2.2314884058 1.12699727536
NODE 13 -1.46953792424 2.55643848485 0.239541621212
NODE 14 -1.38061322222 2.99626194444 -1.20307816667
NODE 15 -1.35525526866 3.4452158209 -2.93117402985
NODE 16 -1.13846633333 3.66244878788 -5.35364621212
NODE 17 -1.02300105 3.7040895 -6.0792445
NODE 18 -1.11883416667 3.71094222222 -6.63840277778
NODE 19 -1.149096 3.662241 -7.044456
NODE 20 -1.1708755 3.636379 -7.175125
NODE 21 -1.2108709 3.6127705 -7.436756
NODE 22 -1.3368006 3.5838725 -7.6767975
NODE 23 -1.38658295 3.5473215 -7.930561
NODE 24 -1.466474 3.510396 -8.1766595
NODE 25 -1.5417544186 3.44172372093 -8.56131906977
NODE 26 -1.71993 3.36622055556 -9.2106825
NODE 27 -2.33728916667 3.09243194444 -10.8213472222
NODE 28 -2.84527265306 2.85796693878 -11.7995734694
NODE 29 -3.47391125 2.966410625 -12.7576729167
NODE 30 -3.8710075 3.07590694444 -13.7540472222
NODE 31 -4.22632291667 3.253575 -14.92424375
NODE 32 -4.81649861111 3.65880222222 -16.5915721389
NODE 33 -5.44864173077 4.05918576923 -17.7887019615
NODE 34 -6.21188277778 4.99117222222 -19.2860055278
NODE 35 -6.85779111111 5.6931575 -20.6306249167
NODE 36 -7.49381027778 6.15135055556 -21.9297639444
NODE 37 -7.79887527778 6.29462083333 -22.9137083889
NODE 38 -1.92647416667 1.0231185 6.06772805556
NODE 39 -2.18345416667 1.24856722222 6.13574888889
NODE 40 -2.28610666667 1.78635444444 5.83354583333
NODE 41 -2.22321 2.22326194444 5.637985
NODE 42 -1.71547111111 3.02247361111 5.44980083333
NODE 43 -1.19434338889 3.59187083333 5.12066
NODE 44 -1.22963944444 3.9180625 4.55700416667
NODE 45 -1.48085416667 4.141465 4.10051666667
NODE 46 -1.85181583333 4.34424416667 3.59270388889
NODE 47 -2.33797694444 4.408815 3.40751666667
NODE 48 -1.24246 3.76173138889 4.85900805556
NODE 49 -0.645128805556 3.87766722222 4.99926527778
NODE 50 0.475237972222 3.8577325 5.14077166667
NODE 51 1.1796625 3.74456916667 4.89533472222
NODE 52 1.82953222222 3.68061166667 4.64490611111
NODE 53 -1.75343027778 1.05141880556 5.27121972222
NODE 54 -1.78589138889 1.57982472222 4.61458555556
NODE 55 -1.89874027778 1.94741 4.41509416667
NODE 56 -1.8964025 2.12657472222 4.37097972222
NODE 57 -1.86907638889 2.42959861111 4.10726944444
NODE 58 -1.77736388889 2.81937138889 3.68955027778
NODE 59 -1.617655 3.12647722222 3.26055138889
NODE 60 -1.35211094286 3.551472 2.36519742857
NODE 61 -1.23267844444 3.79499111111 1.56401638889
NODE 62 -1.15018897222 3.94307666667 1.12110333333
NODE 63 -1.10501177778 4.117795 0.621479583333
NODE 64 -1.02585572222 4.25770805556 0.0652714166667
NODE 65 -1.1214065 4.42043 -0.791030611111
NODE 66 -1.70084194444 1.56835694444 3.05907444444
NODE 67 -2.19115833333 1.61912972222 2.88765472222
NODE 68 -2.57003111111 1.65307111111 2.74516527778
NODE 69 -2.95909 1.5320125 2.60394861111
NODE 70 -3.681615 1.12293838889 2.32921444444
NODE 71 -4.20886694444 0.837428166667 2.29646638889
NODE 72 -4.9184325 0.600697861111 2.33302722222
NODE 73 -5.44052333333 0.220002111111 2.13395444444
NODE 74 -5.74371222222 0.07102725 1.95684972222
NODE 75 -1.759 1.4872 3.63519972222
NODE 76 -1.43804583333 1.85717777778 3.43892666667
NODE 77 -0.965540722222 2.36632861111 3.24553055556
NODE 78 0.341979194444 2.15855583333 2.99951861111
NODE 79 1.39143194444 1.657135 2.57953472222
NODE 80 1.86114333333 1.555265 2.32602138889
NODE 81 2.44806 1.46624444444 1.97889527778
NODE 82 3.08344555556 1.25835027778 1.53645305556
NODE 83 3.42852527778 1.09007886111 1.41298666667
NODE 84 -1.07513801538 3.68482538462 -5.65265984615
NODE 85 -1.0342967 3.698995 -6.043463
NODE 86 -0.9543004 3.714572 -6.456379
NODE 87 -0.727541333333 3.83813194444 -6.89911
NODE 88 -0.488627166667 3.89278138889 -7.41537555556
NODE 89 -0.0832008333333 3.92817694444 -8.218475
NODE 90 0.438935305556 3.87646583333 -9.42413888889
NODE 91 1.04186333333 3.74229055556 -10.7773861111
NODE 92 1.55081055556 3.46128583333 -11.81045
NODE 93 1.97199083333 3.46228861111 -12.2425277778
NODE 94 2.85360722222 3.49282777778 -13.2748194444
NODE 95 3.42458791667 3.74639916667 -13.9914166667
NODE 96 4.3890125 4.47090083333 -15.8718360556
NODE 97 5.31703745098 5.42093862745 -17.6690056471
NODE 98 6.05897694444 6.57058972222 -19.4453582778
NODE 99 6.87075133333 7.28682533333 -21.4167244222
NODE 100 6.94019645833 7.33832895833 -21.6053457083
NODE 101 7.31461860465 7.45756744186 -22.6979837442
NODE 102 1.64251944444 3.39405 -11.840475
NODE 103 1.61998805556 3.0180925 -12.1970944444
NODE 104 1.96456 2.37104472222 -12.9085361111
NODE 105 2.29338944444 1.87716444444 -13.4732
NODE 106 2.55835055556 1.40651666667 -14.078625
NODE 107 3.02511944444 0.828410527778 -14.7823694444
NODE 108 3.46842 0.291080166667 -15.4559722222
NODE 109 3.65569027778 -0.356478333333 -15.8307138611
NODE 110 3.83950944444 -0.748770944444 -16.0467055
NODE 111 4.12379888889 -1.65971916667 -16.6487943056
NODE 112 4.408455 -2.33418722222 -17.1298889444
NODE 113 4.7680075 -2.5807025 -17.3982945278
NODE 114 5.11201277778 -2.73878138889 -17.6278831667
NODE 115 -2.59019897959 2.96901571429 -11.3148632653
NODE 116 -2.74391916667 2.62230444444 -12.0624888889
NODE 117 -2.72392777778 2.4647475 -12.474725
NODE 118 -2.7891275 2.32785107143 -13.2386964286
NODE 119 -2.83806413793 2.23133344828 -13.6609965517
NODE 120 -2.89821666667 2.10293259259 -14.0286666667
NODE 121 -2.95715 1.9180556 -14.465416
NODE 122 -2.99757857143 1.62551214286 -14.8812321429
NODE 123 -3.03671821429 1.2395275 -15.2261428571
NODE 124 -3.09490466667 0.770001233333 -15.4927066667
NODE 125 -3.18962814815 0.267769074074 -15.7360111111
NODE 126 -3.34989833333 -0.196995533333 -15.9859698667
NODE 127 -3.58482333333 -0.897399666667 -16.1351001111
NODE 128 -3.7746525 -1.36251888889 -16.3044416389
NODE 129 -4.02127666667 -1.95876916667 -16.6252583056
NODE 130 -4.06090333333 -2.47839416667 -17.0119833056
NODE 131 -4.2424725 -2.86636555556 -17.2937973333
NODE 132 -4.35732055556 -3.01194944444 -17.3773001389
NODE 133 -4.35732055556 -3.01194944444 -17.3773001389
</pre>
</div></p>

<p><br>
Create 123 joints.
<div style="height:200px;overflow:auto;">
<pre>
JOINT J1 1 IN1 OUT1
JOINTINLET IN1 1 0
JOINTOUTLET OUT1 1 1<br>
JOINT J2 2 IN2 OUT2
JOINTINLET IN2 1 1
JOINTOUTLET OUT2 1 2<br>
JOINT J3 3 IN3 OUT3
JOINTINLET IN3 1 2
JOINTOUTLET OUT3 1 3<br>
JOINT J4 4 IN4 OUT4
JOINTINLET IN4 1 3
JOINTOUTLET OUT4 1 4<br>
JOINT J5 5 IN5 OUT5
JOINTINLET IN5 1 4
JOINTOUTLET OUT5 1 5<br>
JOINT J6 6 IN6 OUT6
JOINTINLET IN6 1 5
JOINTOUTLET OUT6 1 6<br>
JOINT J7 7 IN7 OUT7
JOINTINLET IN7 1 6
JOINTOUTLET OUT7 1 7<br>
JOINT J8 8 IN8 OUT8
JOINTINLET IN8 1 7
JOINTOUTLET OUT8 1 8<br>
JOINT J9 38 IN9 OUT9
JOINTINLET IN9 1 8
JOINTOUTLET OUT9 3 9 37 50<br>
JOINT J10 39 IN10 OUT10
JOINTINLET IN10 1 37
JOINTOUTLET OUT10 1 38<br>
JOINT J11 54 IN11 OUT11
JOINTINLET IN11 1 50
JOINTOUTLET OUT11 1 51<br>
JOINT J12 75 IN12 OUT12
JOINTINLET IN12 1 9
JOINTOUTLET OUT12 2 10 70<br>
JOINT J13 76 IN13 OUT13
JOINTINLET IN13 1 70
JOINTOUTLET OUT13 1 71<br>
JOINT J14 66 IN14 OUT14
JOINTINLET IN14 1 10
JOINTOUTLET OUT14 2 11 62<br>
JOINT J15 67 IN15 OUT15
JOINTINLET IN15 1 62
JOINTOUTLET OUT15 1 63<br>
JOINT J16 12 IN16 OUT16
JOINTINLET IN16 1 11
JOINTOUTLET OUT16 1 12<br>
JOINT J17 13 IN17 OUT17
JOINTINLET IN17 1 12
JOINTOUTLET OUT17 1 13<br>
JOINT J18 14 IN18 OUT18
JOINTINLET IN18 1 13
JOINTOUTLET OUT18 1 14<br>
JOINT J19 15 IN19 OUT19
JOINTINLET IN19 1 14
JOINTOUTLET OUT19 1 15<br>
JOINT J20 16 IN20 OUT20
JOINTINLET IN20 1 15
JOINTOUTLET OUT20 1 16<br>
JOINT J21 84 IN21 OUT21
JOINTINLET IN21 1 16
JOINTOUTLET OUT21 2 17 78<br>
JOINT J22 85 IN22 OUT22
JOINTINLET IN22 1 78
JOINTOUTLET OUT22 1 79<br>
JOINT J23 18 IN23 OUT23
JOINTINLET IN23 1 17
JOINTOUTLET OUT23 1 18<br>
JOINT J24 19 IN24 OUT24
JOINTINLET IN24 1 18
JOINTOUTLET OUT24 1 19<br>
JOINT J25 20 IN25 OUT25
JOINTINLET IN25 1 19
JOINTOUTLET OUT25 1 20<br>
JOINT J26 21 IN26 OUT26
JOINTINLET IN26 1 20
JOINTOUTLET OUT26 1 21<br>
JOINT J27 22 IN27 OUT27
JOINTINLET IN27 1 21
JOINTOUTLET OUT27 1 22<br>
JOINT J28 23 IN28 OUT28
JOINTINLET IN28 1 22
JOINTOUTLET OUT28 1 23<br>
JOINT J29 24 IN29 OUT29
JOINTINLET IN29 1 23
JOINTOUTLET OUT29 1 24<br>
JOINT J30 25 IN30 OUT30
JOINTINLET IN30 1 24
JOINTOUTLET OUT30 1 25<br>
JOINT J31 26 IN31 OUT31
JOINTINLET IN31 1 25
JOINTOUTLET OUT31 1 26<br>
JOINT J32 27 IN32 OUT32
JOINTINLET IN32 1 26
JOINTOUTLET OUT32 1 27<br>
JOINT J33 115 IN33 OUT33
JOINTINLET IN33 1 27
JOINTOUTLET OUT33 2 28 107<br>
JOINT J34 116 IN34 OUT34
JOINTINLET IN34 1 107
JOINTOUTLET OUT34 1 108<br>
JOINT J35 29 IN35 OUT35
JOINTINLET IN35 1 28
JOINTOUTLET OUT35 1 29<br>
JOINT J36 30 IN36 OUT36
JOINTINLET IN36 1 29
JOINTOUTLET OUT36 1 30<br>
JOINT J37 31 IN37 OUT37
JOINTINLET IN37 1 30
JOINTOUTLET OUT37 1 31<br>
JOINT J38 32 IN38 OUT38
JOINTINLET IN38 1 31
JOINTOUTLET OUT38 1 32<br>
JOINT J39 33 IN39 OUT39
JOINTINLET IN39 1 32
JOINTOUTLET OUT39 1 33<br>
JOINT J40 34 IN40 OUT40
JOINTINLET IN40 1 33
JOINTOUTLET OUT40 1 34<br>
JOINT J41 35 IN41 OUT41
JOINTINLET IN41 1 34
JOINTOUTLET OUT41 1 35<br>
JOINT J42 36 IN42 OUT42
JOINTINLET IN42 1 35
JOINTOUTLET OUT42 1 36<br>
JOINT J44 40 IN44 OUT44
JOINTINLET IN44 1 38
JOINTOUTLET OUT44 1 39<br>
JOINT J45 41 IN45 OUT45
JOINTINLET IN45 1 39
JOINTOUTLET OUT45 1 40<br>
JOINT J46 42 IN46 OUT46
JOINTINLET IN46 1 40
JOINTOUTLET OUT46 1 41<br>
JOINT J47 43 IN47 OUT47
JOINTINLET IN47 1 41
JOINTOUTLET OUT47 1 42<br>
JOINT J48 48 IN48 OUT48
JOINTINLET IN48 1 42
JOINTOUTLET OUT48 2 43 46<br>
JOINT J49 49 IN49 OUT49
JOINTINLET IN49 1 46
JOINTOUTLET OUT49 1 47<br>
JOINT J50 45 IN50 OUT50
JOINTINLET IN50 1 43
JOINTOUTLET OUT50 1 44<br>
JOINT J51 46 IN51 OUT51
JOINTINLET IN51 1 44
JOINTOUTLET OUT51 1 45<br>
JOINT J53 50 IN53 OUT53
JOINTINLET IN53 1 47
JOINTOUTLET OUT53 1 48<br>
JOINT J54 51 IN54 OUT54
JOINTINLET IN54 1 48
JOINTOUTLET OUT54 1 49<br>
JOINT J56 55 IN56 OUT56
JOINTINLET IN56 1 51
JOINTOUTLET OUT56 1 52<br>
JOINT J57 56 IN57 OUT57
JOINTINLET IN57 1 52
JOINTOUTLET OUT57 1 53<br>
JOINT J58 57 IN58 OUT58
JOINTINLET IN58 1 53
JOINTOUTLET OUT58 1 54<br>
JOINT J59 58 IN59 OUT59
JOINTINLET IN59 1 54
JOINTOUTLET OUT59 1 55<br>
JOINT J60 59 IN60 OUT60
JOINTINLET IN60 1 55
JOINTOUTLET OUT60 1 56<br>
JOINT J61 60 IN61 OUT61
JOINTINLET IN61 1 56
JOINTOUTLET OUT61 1 57<br>
JOINT J62 61 IN62 OUT62
JOINTINLET IN62 1 57
JOINTOUTLET OUT62 1 58<br>
JOINT J63 62 IN63 OUT63
JOINTINLET IN63 1 58
JOINTOUTLET OUT63 1 59<br>
JOINT J64 63 IN64 OUT64
JOINTINLET IN64 1 59
JOINTOUTLET OUT64 1 60<br>
JOINT J65 64 IN65 OUT65
JOINTINLET IN65 1 60
JOINTOUTLET OUT65 1 61<br>
JOINT J67 68 IN67 OUT67
JOINTINLET IN67 1 63
JOINTOUTLET OUT67 1 64<br>
JOINT J68 69 IN68 OUT68
JOINTINLET IN68 1 64
JOINTOUTLET OUT68 1 65<br>
JOINT J69 70 IN69 OUT69
JOINTINLET IN69 1 65
JOINTOUTLET OUT69 1 66<br>
JOINT J70 71 IN70 OUT70
JOINTINLET IN70 1 66
JOINTOUTLET OUT70 1 67<br>
JOINT J71 72 IN71 OUT71
JOINTINLET IN71 1 67
JOINTOUTLET OUT71 1 68<br>
JOINT J72 73 IN72 OUT72
JOINTINLET IN72 1 68
JOINTOUTLET OUT72 1 69<br>
JOINT J74 77 IN74 OUT74
JOINTINLET IN74 1 71
JOINTOUTLET OUT74 1 72<br>
JOINT J75 78 IN75 OUT75
JOINTINLET IN75 1 72
JOINTOUTLET OUT75 1 73<br>
JOINT J76 79 IN76 OUT76
JOINTINLET IN76 1 73
JOINTOUTLET OUT76 1 74<br>
JOINT J77 80 IN77 OUT77
JOINTINLET IN77 1 74
JOINTOUTLET OUT77 1 75<br>
JOINT J78 81 IN78 OUT78
JOINTINLET IN78 1 75
JOINTOUTLET OUT78 1 76<br>
JOINT J79 82 IN79 OUT79
JOINTINLET IN79 1 76
JOINTOUTLET OUT79 1 77<br>
JOINT J81 86 IN81 OUT81
JOINTINLET IN81 1 79
JOINTOUTLET OUT81 1 80<br>
JOINT J82 87 IN82 OUT82
JOINTINLET IN82 1 80
JOINTOUTLET OUT82 1 81<br>
JOINT J83 88 IN83 OUT83
JOINTINLET IN83 1 81
JOINTOUTLET OUT83 1 82<br>
JOINT J84 89 IN84 OUT84
JOINTINLET IN84 1 82
JOINTOUTLET OUT84 1 83<br>
JOINT J85 90 IN85 OUT85
JOINTINLET IN85 1 83
JOINTOUTLET OUT85 1 84<br>
JOINT J86 91 IN86 OUT86
JOINTINLET IN86 1 84
JOINTOUTLET OUT86 1 85<br>
JOINT J87 133 IN87 OUT87
JOINTINLET IN87 1 85
JOINTOUTLET OUT87 2 86 95<br>
JOINT J88 103 IN88 OUT88
JOINTINLET IN88 1 95
JOINTOUTLET OUT88 1 96<br>
JOINT J89 93 IN89 OUT89
JOINTINLET IN89 1 86
JOINTOUTLET OUT89 1 87<br>
JOINT J90 94 IN90 OUT90
JOINTINLET IN90 1 87
JOINTOUTLET OUT90 1 88<br>
JOINT J91 95 IN91 OUT91
JOINTINLET IN91 1 88
JOINTOUTLET OUT91 1 89<br>
JOINT J92 96 IN92 OUT92
JOINTINLET IN92 1 89
JOINTOUTLET OUT92 1 90<br>
JOINT J93 97 IN93 OUT93
JOINTINLET IN93 1 90
JOINTOUTLET OUT93 1 91<br>
JOINT J94 98 IN94 OUT94
JOINTINLET IN94 1 91
JOINTOUTLET OUT94 1 92<br>
JOINT J95 99 IN95 OUT95
JOINTINLET IN95 1 92
JOINTOUTLET OUT95 1 93<br>
JOINT J96 100 IN96 OUT96
JOINTINLET IN96 1 93
JOINTOUTLET OUT96 1 94<br>
JOINT J98 104 IN98 OUT98
JOINTINLET IN98 1 96
JOINTOUTLET OUT98 1 97<br>
JOINT J99 105 IN99 OUT99
JOINTINLET IN99 1 97
JOINTOUTLET OUT99 1 98<br>
JOINT J100 106 IN100 OUT100
JOINTINLET IN100 1 98
JOINTOUTLET OUT100 1 99<br>
JOINT J101 107 IN101 OUT101
JOINTINLET IN101 1 99
JOINTOUTLET OUT101 1 100<br>
JOINT J102 108 IN102 OUT102
JOINTINLET IN102 1 100
JOINTOUTLET OUT102 1 101<br>
JOINT J103 109 IN103 OUT103
JOINTINLET IN103 1 101
JOINTOUTLET OUT103 1 102<br>
JOINT J104 110 IN104 OUT104
JOINTINLET IN104 1 102
JOINTOUTLET OUT104 1 103<br>
JOINT J105 111 IN105 OUT105
JOINTINLET IN105 1 103
JOINTOUTLET OUT105 1 104<br>
JOINT J106 112 IN106 OUT106
JOINTINLET IN106 1 104
JOINTOUTLET OUT106 1 105<br>
JOINT J107 113 IN107 OUT107
JOINTINLET IN107 1 105
JOINTOUTLET OUT107 1 106<br>
JOINT J109 117 IN109 OUT109
JOINTINLET IN109 1 108
JOINTOUTLET OUT109 1 109<br>
JOINT J110 118 IN110 OUT110
JOINTINLET IN110 1 109
JOINTOUTLET OUT110 1 110<br>
JOINT J111 119 IN111 OUT111
JOINTINLET IN111 1 110
JOINTOUTLET OUT111 1 111<br>
JOINT J112 120 IN112 OUT112
JOINTINLET IN112 1 111
JOINTOUTLET OUT112 1 112<br>
JOINT J113 121 IN113 OUT113
JOINTINLET IN113 1 112
JOINTOUTLET OUT113 1 113<br>
JOINT J114 122 IN114 OUT114
JOINTINLET IN114 1 113
JOINTOUTLET OUT114 1 114<br>
JOINT J115 123 IN115 OUT115
JOINTINLET IN115 1 114
JOINTOUTLET OUT115 1 115<br>
JOINT J116 124 IN116 OUT116
JOINTINLET IN116 1 115
JOINTOUTLET OUT116 1 116<br>
JOINT J117 125 IN117 OUT117
JOINTINLET IN117 1 116
JOINTOUTLET OUT117 1 117<br>
JOINT J118 126 IN118 OUT118
JOINTINLET IN118 1 117
JOINTOUTLET OUT118 1 118<br>
JOINT J119 127 IN119 OUT119
JOINTINLET IN119 1 118
JOINTOUTLET OUT119 1 119<br>
JOINT J120 128 IN120 OUT120
JOINTINLET IN120 1 119
JOINTOUTLET OUT120 1 120<br>
JOINT J121 129 IN121 OUT121
JOINTINLET IN121 1 120
JOINTOUTLET OUT121 1 121<br>
JOINT J122 130 IN122 OUT122
JOINTINLET IN122 1 121
JOINTOUTLET OUT122 1 122<br>
JOINT J123 131 IN123 OUT123
JOINTINLET IN123 1 122
JOINTOUTLET OUT123 1 123
</pre>
</div></p>

<p><br>
Create segments.
<div style="height:200px;overflow:auto;">
<pre>
SEGMENT aorta_0 0 0.130801169103 50 0 1 2.18575761457 2.2649371265 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_1 1 1.32664025533 50 1 2 2.2649371265 2.26347210256 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_2 2 1.44876200411 50 2 3 2.26347210256 2.67402504902 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_3 3 1.52697765144 50 3 4 2.67402504902 2.47785554886 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_4 4 1.39434516119 50 4 5 2.47785554886 2.14998027839 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_5 5 1.25148440552 50 5 6 2.14998027839 2.12587637711 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_6 6 1.1740463278 50 6 7 2.12587637711 2.23608509069 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_7 7 1.23552232351 50 7 8 2.23608509069 2.03876380823 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_8 8 1.18236403081 50 8 9 2.03876380823 1.83335445833 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_9 9 1.85262148457 50 9 10 1.83335445833 1.44901981834 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_10 10 1.21259577109 50 10 11 1.44901981834 1.10622883286 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_11 11 1.41460477782 50 11 12 1.10622883286 1.42761719935 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_12 12 0.953772658033 50 12 13 1.42761719935 1.32622573266 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_13 13 1.51079586001 50 13 14 1.32622573266 1.56292588145 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_14 14 1.78564215938 50 14 15 1.56292588145 1.42520398245 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_15 15 2.44183518655 50 15 16 1.42520398245 1.20100416435 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_16 16 0.735906961466 50 16 17 1.20100416435 1.13116662193 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_17 17 0.56735255852 50 17 18 1.13116662193 0.921878071016 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_18 18 0.410081463711 50 18 19 0.921878071016 0.822029633442 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_19 19 0.134972505442 50 19 20 0.822029633442 0.754476473126 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_20 20 0.2657212326 50 20 21 0.754476473126 0.678287353449 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_21 21 0.272604668831 50 21 22 0.678287353449 0.51697288866 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_22 22 0.261170771536 50 22 23 0.51697288866 0.486035662169 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_23 23 0.261362859111 50 23 24 0.486035662169 0.470074480377 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_24 24 0.397927138999 50 24 25 0.470074480377 0.488079175944 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_25 25 0.677584039297 50 25 26 0.488079175944 0.456448783863 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_26 26 1.7465203668 50 26 27 0.456448783863 0.519169530874 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_27 27 1.12691954104 50 27 28 0.519169530874 0.810741273029 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_28 28 1.15104346987 50 28 29 0.810741273029 0.551125937599 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_29 29 1.07816354627 50 29 30 0.551125937599 0.64719565376 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_30 30 1.2357891798 50 30 31 0.64719565376 0.548962857424 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_31 31 1.81452484368 50 31 32 0.548962857424 0.607523363741 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_32 32 1.41174775393 50 32 33 0.607523363741 0.554197999419 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_33 33 1.9217319308 50 33 34 0.554197999419 0.598445165018 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_34 34 1.64863040317 50 34 35 0.598445165018 0.536475301284 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_35 35 1.51730796809 50 35 36 0.536475301284 0.649529888766 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT aorta_36 36 1.04006619812 50 36 37 0.649529888766 0.491677203125 0.0 MAT1 NONE 0.0 0 0 RESISTANCE R_LEI
SEGMENT celiac_trunk_0 37 0.348558001657 50 38 39 1.10023514812 0.483437149315 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT celiac_trunk_1 38 0.625363349525 50 39 40 0.483437149315 0.218618914095 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT celiac_trunk_2 39 0.482792081302 50 40 41 0.218618914095 0.327714237373 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT celiac_trunk_3 40 0.965376272761 50 41 42 0.327714237373 0.412926060659 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT celiac_trunk_4 41 0.839119173723 50 42 43 0.412926060659 0.412927671947 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT celiac_trunk_5 42 0.652192236531 50 43 44 0.412927671947 0.218618724922 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT celiac_trunk_6 43 0.56692005726 50 44 45 0.218618724922 0.270368247353 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT celiac_trunk_7 44 0.660761504512 50 45 46 0.270368247353 0.270368135023 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT celiac_trunk_8 45 0.524229268306 50 46 47 0.270368135023 0.187214080183 0.0 MAT1 NONE 0.0 0 0 RESISTANCE R_TRUNK
SEGMENT celiac_branch_0 46 0.624433953027 50 48 49 0.158274065527 0.187214552437 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT celiac_branch_1 47 1.12944374273 50 49 50 0.187214552437 0.119469806645 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT celiac_branch_2 48 0.754492643466 50 50 51 0.119469806645 0.158275045675 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT celiac_branch_3 49 0.699382375336 50 51 52 0.158275045675 0.11946973669 0.0 MAT1 NONE 0.0 0 0 RESISTANCE R_BRANCH
SEGMENT superior_mesentaric_12 50 0.843466042788 50 53 54 0.759713680164 0.759711442514 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT superior_mesentaric_11 51 0.433186590747 50 54 55 0.759711442514 0.483437853988 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT superior_mesentaric_10 52 0.184530612914 50 55 56 0.483437853988 0.369068379484 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT superior_mesentaric_9 53 0.402632964611 50 56 57 0.369068379484 0.288862639778 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT superior_mesentaric_8 54 0.57863918218 50 57 58 0.288862639778 0.270370161138 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT superior_mesentaric_7 55 0.551235855805 50 58 59 0.270370161138 0.327715371413 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT superior_mesentaric_6 56 1.02605697779 50 59 60 0.327715371413 0.421376819704 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT superior_mesentaric_5 57 0.845846757693 50 60 61 0.421376819704 0.187215137164 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT superior_mesentaric_4 58 0.474242363748 50 61 62 0.187215137164 0.218619491979 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT superior_mesentaric_3 59 0.531216873287 50 62 63 0.218619491979 0.252498535215 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT superior_mesentaric_2 60 0.578972252282 50 63 64 0.252498535215 0.202609078816 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT superior_mesentaric_1 61 0.87684750391 50 64 65 0.202609078816 0.2525013095 0.0 MAT1 NONE 0.0 0 0 RESISTANCE R_SMA
SEGMENT renal_left_0 62 0.521893434853 50 66 67 0.369067273304 0.36906931377 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_left_1 63 0.406201725007 50 67 68 0.36906931377 0.369071544506 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_left_2 64 0.431235612273 50 68 69 0.369071544506 0.369067805774 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_left_3 65 0.874564386618 50 69 70 0.369067805774 0.270370686102 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_left_4 66 0.600485749253 50 70 71 0.270370686102 0.144726659313 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_left_5 67 0.748906676251 50 71 72 0.144726659313 0.107759105245 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_left_6 68 0.676119858583 50 72 73 0.107759105245 0.107758551394 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_left_7 69 0.381422461612 50 73 74 0.107758551394 0.144726903201 0.0 MAT1 NONE 0.0 0 0 RESISTANCE R_RL
SEGMENT renal_right_0 70 0.527653527883 50 75 76 0.144728286338 0.158274062451 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_right_1 71 0.721039324103 50 76 77 0.158274062451 0.144727318024 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_right_2 72 1.3465881837 50 77 78 0.144727318024 0.119470021628 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_right_3 73 1.2365922503 50 78 79 0.119470021628 0.119469068929 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_right_4 74 0.543392395907 50 79 80 0.119469068929 0.13179194148 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_right_5 75 0.68767170215 50 80 81 0.13179194148 0.158274146293 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_right_6 76 0.801679430164 50 81 82 0.158274146293 0.119470715295 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT renal_right_7 77 0.403285548391 50 82 83 0.119470715295 0.119469202409 0.0 MAT1 NONE 0.0 0 0 RESISTANCE R_RR
SEGMENT right_iliac_0 78 0.393186846294 50 84 85 0.929630455645 1.1590911199 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_1 79 0.420882019096 50 85 86 1.1590911199 1.15140826804 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_2 80 0.512540215542 50 86 87 1.15140826804 0.790855717763 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_3 81 0.571486364374 50 87 88 0.790855717763 0.759711258866 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_4 82 0.900328870347 50 88 89 0.759711258866 0.613607332101 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_5 83 1.31488615458 50 89 90 0.613607332101 0.613607236162 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_6 84 1.48754941306 50 90 91 0.613607236162 0.613605315242 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_7 85 1.18541635194 50 91 92 0.613605315242 0.559635046555 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_8 86 0.603394595602 50 92 93 0.559635046555 0.485336749744 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_9 87 1.35786824947 50 93 94 0.485336749744 0.559625498567 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_10 88 0.950699206683 50 94 95 0.559625498567 0.697780935632 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_11 89 2.23405338344 50 95 96 0.697780935632 0.609948200703 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_12 90 2.23464105854 50 96 97 0.609948200703 0.595830745789 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_13 91 2.24223114784 50 97 98 0.595830745789 0.574139667224 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_14 92 2.24905659879 50 98 99 0.574139667224 0.641739308346 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_15 93 0.207492742882 50 99 100 0.641739308346 0.653417735031 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_iliac_16 94 1.16114927421 50 100 101 0.653417735031 0.423351838315 0.0 MAT1 NONE 0.0 0 0 RESISTANCE R_REI
SEGMENT right_internal_iliac_0 95 0.518680184167 50 102 103 0.270366667156 0.270366614873 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_internal_iliac_1 96 1.02154290008 50 103 104 0.270366614873 0.27036551134 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_internal_iliac_2 97 0.819079873838 50 104 105 0.27036551134 0.218619768158 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_internal_iliac_3 98 0.81132801736 50 105 106 0.218619768158 0.270369169198 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_internal_iliac_4 99 1.02339442374 50 106 107 0.270369169198 0.235254291819 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_internal_iliac_5 100 0.969009804779 50 107 108 0.235254291819 0.235249939024 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_internal_iliac_6 101 0.771254474073 50 108 109 0.235249939024 0.235251165405 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_internal_iliac_7 102 0.48408198359 50 109 110 0.235251165405 0.235258883988 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_internal_iliac_8 103 1.12834306909 50 110 111 0.235258883988 0.158269047299 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_internal_iliac_9 104 0.87600702687 50 111 112 0.158269047299 0.158279603978 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_internal_iliac_10 105 0.511946617919 50 112 113 0.158279603978 0.187216424318 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT right_internal_iliac_11 106 0.442763491447 50 113 114 0.187216424318 0.144733938941 0.0 MAT1 NONE 0.0 0 0 RESISTANCE R_RII
SEGMENT left_internal_iliac_0 107 0.838321342676 50 115 116 0.358566452164 0.270372495723 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_1 108 0.441771952116 50 116 117 0.270372495723 0.218618731619 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_2 109 0.778873532486 50 117 118 0.218618731619 0.205958915985 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_3 110 0.435944767288 50 118 119 0.205958915985 0.21841852431 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_4 111 0.394063979419 50 119 120 0.21841852431 0.199743070027 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_5 112 0.477914867246 50 120 121 0.199743070027 0.197386008705 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_6 113 0.510018831383 50 121 122 0.197386008705 0.214154421091 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_7 114 0.519114107874 50 122 123 0.214154421091 0.206511841345 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_8 115 0.543044052429 50 123 124 0.206511841345 0.22060838804 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_9 116 0.566044814855 50 124 125 0.22060838804 0.20884481899 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_10 117 0.551517952597 50 125 126 0.20884481899 0.226533434217 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_11 118 0.753654785312 50 126 127 0.226533434217 0.187199335475 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_12 119 0.530139185901 50 127 128 0.187199335475 0.187212559352 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_13 120 0.720597812198 50 128 129 0.187212559352 0.119466921657 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_14 121 0.64895041333 50 129 130 0.119466921657 0.158270198303 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_15 122 0.51274585043 50 130 131 0.158270198303 0.187217430354 0.0 MAT1 NONE 0.0 0 0 NOBOUND NONE
SEGMENT left_internal_iliac_16 123 0.203365343912 50 131 132 0.187217430354 0.187217122515 0.0 MAT1 NONE 0.0 0 0 RESISTANCE R_LII
</pre>
</div></p>

<p><br>
Create a data table for the aorta inlet flow boundary condition.</p>

<div style="height:200px;overflow:auto;">
<pre>
DATATABLE INLETDATA LIST
0.0 24.9485671447
0.00401706131058 25.038543576
0.00804158927788 25.1253750951
0.0120586505885 25.3133340807
0.0160831785558 25.7172792237
0.0201002398663 26.4516350474
0.0241173011769 27.6195531882
0.0281418291442 29.3038021034
0.0321588904548 31.5606599331
0.0361834184221 34.4176116259
0.0402004797327 37.8750455157
0.0442175410433 41.9115017555
0.0482420690106 46.4914673291
0.0522591303212 51.5743145829
0.0562836582885 57.1228256834
0.060300719599 63.1098514231
0.0643252475663 69.5220015042
0.0683423088769 76.3597981496
0.0723593701875 83.6343477651
0.0763838981548 91.3611943552
0.0804009594654 99.5525021976
0.0844254874327 108.208997219
0.0884425487433 117.313126431
0.0924596100539 126.824666809
0.0964841380211 136.679580202
0.100501199332 146.792340186
0.104525727299 157.061354108
0.10854278861 167.376580507
0.11255984992 177.628083291
0.116584377887 187.714136939
0.120601439198 197.547616689
0.124625967165 207.059750772
0.128643028476 216.200813465
0.132660089787 224.937897126
0.136684617754 233.250429224
0.140701679064 241.12448159
0.144726207032 248.547101058
0.148743268342 255.501829545
0.152760329653 261.966302945
0.15678485762 267.91235955
0.160801918931 273.308561533
0.164826446898 278.124512738
0.168843508209 282.335962851
0.172860569519 285.929487871
0.176885097487 288.90557465
0.180902158797 291.279208303
0.184926686764 293.077520075
0.188943748075 294.334618627
0.192968276042 295.084290955
0.196985337353 295.351725893
0.201002398663 295.145680584
0.205026926631 294.452540193
0.209043987941 293.233485586
0.213068515909 291.425532597
0.217085577219 288.946601564
0.22110263853 285.70412707
0.225127166497 281.606131294
0.229144227808 276.573264115
0.233168755775 270.550125543
0.237185817086 263.51427286
0.241202878396 255.481650163
0.245227406363 246.507714017
0.249244467674 236.684172337
0.253268995641 226.131893546
0.257286056952 214.991082946
0.261303118263 203.410169094
0.26532764623 191.534949707
0.26934470754 179.499405635
0.273369235508 167.41923233
0.277386296818 155.388639562
0.281403358129 143.480410496
0.285427886096 131.748704658
0.289444947407 120.233702756
0.293469475374 108.966999282
0.297486536685 97.9766585376
0.301503597995 87.2910578797
0.305528125962 76.9409855029
0.309545187273 66.9598753462
0.31356971524 57.3824574617
0.317586776551 48.2424082888
0.321611304518 39.569743891
0.325628365829 31.3886895826
0.329645427139 23.7165911301
0.333669955107 16.5641438274
0.337687016417 9.93688018295
0.341711544385 3.83753834884
0.345728605695 -1.73129722655
0.349745667006 -6.76498144367
0.353770194973 -11.2556542907
0.357787256284 -15.1925670479
0.361811784251 -18.5639944198
0.365828845562 -21.3604787071
0.369845906872 -23.5788280531
0.373870434839 -25.2260660795
0.37788749615 -26.3224530944
0.381912024117 -26.9027993353
0.385929085428 -27.015546634
0.389946146738 -26.719474801
0.393970674706 -26.0783193949
0.397987736016 -25.1539952306
0.402012263984 -23.9994270173
0.406029325294 -22.6521354593
0.410046386605 -21.1296839164
0.414070914572 -19.4278520119
0.418087975883 -17.5220123013
0.42211250385 -15.3716976869
0.426129565161 -12.9278448545
0.430146626471 -10.1417648421
0.434171154438 -6.97459768401
0.438188215749 -3.40590409029
0.442212743716 0.559852321251
0.446229805027 4.88988390883
0.450254332994 9.52323419211
0.454271394305 14.3745124875
0.458288455615 19.3407053071
0.462312983583 24.3101412797
0.466330044893 29.1724063508
0.470354572861 33.8279151858
0.474371634171 38.1959388674
0.478388695482 42.2201524963
0.482413223449 45.871148806
0.48643028476 49.1458023291
0.490454812727 52.0637949468
0.494471874038 54.6619653254
0.498488935348 56.9873751098
0.502513463315 59.0900727083
0.506530524626 61.0164764312
0.510555052593 62.8041192052
0.514572113904 64.4782349571
0.518589175214 66.0503675931
0.522613703182 67.5188969255
0.526630764492 68.8711433057
0.53065529246 70.0865579991
0.53467235377 71.1404415244
0.538689415081 72.0076559733
0.542713943048 72.6658851088
0.546731004359 73.0981315905
0.550755532326 73.2942889218
0.554772593637 73.2517649691
0.558789654947 72.9752495544
0.562814182914 72.4757923237
0.566831244225 71.7693993197
0.570855772192 70.8753586268
0.574872833503 69.8144948133
0.57889736147 68.6075179102
0.582914422781 67.2736004464
0.586931484091 65.8292837429
0.590956012059 64.2877808751
0.594973073369 62.6587139871
0.598997601337 60.9482898474
0.603014662647 59.1598805908
0.607031723958 57.2949382563
0.611056251925 55.3541315489
0.615073313236 53.3385658404
0.619097841203 51.2509277089
0.623114902513 49.0964028105
0.627131963824 46.8832462501
0.631156491791 44.6229340634
0.635173553102 42.3298944201
0.639198081069 40.0208905863
0.64321514238 37.7141850892
0.64723220369 35.4286569387
0.651256731658 33.1830441259
0.655273792968 30.9954505668
0.659298320936 28.8831861021
0.663315382246 26.8629219606
0.667332443557 24.9510496484
0.671356971524 23.1640581717
0.675374032835 21.5187111666
0.679398560802 20.0318203252
0.683415622113 18.719482153
0.687432683423 17.5957616712
0.69145721139 16.6709456543
0.695474272701 15.9496274427
0.699498800668 15.4289872173
0.703515861979 15.0976749611
0.707540389946 14.9356617551
0.711557451257 14.9153075579
0.715574512567 15.0036963016
0.719599040535 15.1660610822
0.723616101845 15.3698862953
0.727640629812 15.5890888464
0.731657691123 15.8075811185
0.735674752434 16.0215392172
0.739699280401 16.2398440817
0.743716341712 16.4824250012
0.747740869679 16.7765754424
0.751757930989 17.1516703569
0.7557749923 17.6330420974
0.759799520267 18.2359914278
0.763816581578 18.9609858486
0.767841109545 19.7909909825
0.771858170856 20.6916127038
0.775875232166 21.6143095508
0.779899760134 22.502454957
0.783916821444 23.2995386527
0.787941349412 23.9584014928
0.791958410722 24.4501547304
0.795975472033 24.7714012308
0.8 24.9485671447
ENDDATATABLE
</pre>
</div>

<p><br>
Create a data table for the RESISTANCE boundary condition.</p>
<pre class="highlight plaintext"><code>DATATABLE R_TRUNK LIST 
0.0 15911.40456 
10.0 15911.40456 
ENDDATATABLE

DATATABLE R_BRANCH LIST 
0.0 24933.83724    
10.0 24933.83724    
ENDDATATABLE

DATATABLE R_SMA LIST 
0.0 11797.32087
10.0 11797.32087
ENDDATATABLE

DATATABLE R_RR LIST 
0.0 24933.94874
10.0 24933.94874
ENDDATATABLE

DATATABLE R_RL LIST 
0.0 20582.482622
10.0 20582.48262
ENDDATATABLE

DATATABLE R_RII LIST 
0.0 20581.48207
10.0 20581.48207
ENDDATATABLE

DATATABLE R_LII LIST 
0.0 15911.14600
10.0 15911.14600
ENDDATATABLE

DATATABLE R_REI LIST 
0.0 7036.31991
10.0 7036.31991
ENDDATATABLE

DATATABLE R_LEI LIST 
0.0 6058.52570
10.0 6058.52570
ENDDATATABLE
</code></pre>

<p><br>
Create a material named <strong>MAT1</strong> for an OLUFSEN consitutive model with the following parameters
<p style="font-size:11px">
<i>
name = MAT1,
type = OLUFSEN,
density =  1.06,
viscosity = 0.04,
pressure = 113324.0,
exponent = 1.0,
$k_1$ = 2.0e7,
$k_2$ = -22.5267,
$k_3$ = 8.65e5 
</i>
</p></p>
<pre class="highlight plaintext"><code>MATERIAL MAT1 OLUFSEN 1.06 0.04 113324.0 1.0 2.0e7 -22.5267 8.65e5
</code></pre>

<p><br>
Set the solver following solver options
<p style="font-size:11px">
<i>
time step = 0.01, 
save results frequency = 1,
number of time steps = 480, 
number of finite element quadrature points = 2,
inlet boundary conditions data table name = INLETDATA, 
inlet boundary condition type = FLOW,
convergence tolerance = 1.0e-6, 
formulation type = 1 (conservative formulation),
stabilization = 1 (use stabilization) 
</i>
</p></p>
<pre class="highlight plaintext"><code>SOLVEROPTIONS 0.01 1 480 2 INLETDATA FLOW 1.0e-6 1 1 
</code></pre>

<p><br>
Set results to be written for each segment in a separate text file for the flow rate, pressure, area and Reynolds number.</p>
<pre class="highlight plaintext"><code>OUTPUT TEXT
</code></pre>

<p><br>
<h3> Results </h3>
The results of the simulation are shown using the following graphs.</p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/solver/images/Ex12-plottingExample_01.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <img src="documentation/1d_simulation/solver/images/Ex12-plottingExample_12.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>

<p><br>
<figure>
  <img src="documentation/1d_simulation/solver/images/Ex12-plottingExample_13.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <img src="documentation/1d_simulation/solver/images/Ex12-plottingExample_24.png" style="float: left; width: 40%; margin-right: 1%; margin-bottom: 0.5em;">
  <p style="clear: both;">
</figure>
<br></p>
</section>
  <section id="solver-refs" class="subgroup"><h1>References</h1>

<p><a id="ref-1"> 
[1] T.J.R. Hughes and J. Lubliner, <strong>On the One-Dimensional Theory of Blood Flow in the Larger Vessels</strong> , Mathematical Biosciences , 18(1-2) (1973), 161-170. 
</a></p>

<p><a id="ref-2"> 
[2] T.J.R. Hughes, <strong>A Study of the One-Dimensional Theory of Arterial Pulse Propagation</strong>, 1974, U.C. Berkeley, Ph.D. Thesis. </a></p>

<p><a id="ref-3"> 
[3] M.S. Olufsen, <strong>Structured Tree Outflow Condition for Blood Flow in Larger Systemic Arteries</strong> , American Journal of Physiology , 276 (1999), H257-268.
</a></p>

<p><a id="ref-4"> 
[4] J. Wan, B.N. Steele, S.A. Spicer, S. Strohband, G.R. Feijoo, T.J.R. Hughes and C.A. Taylor, <strong>A One-Dimensional Finite Element Method for Simulation-Based Medical Planning for Cardiovascular Disease</strong> , Computer Methods in Biomechanics and Biomedical Engineering , 5(3) (2002), 195-206.
</a></p>

<p><a id="ref-5"> 
[5] D. Givoli and J.B. Keller, <strong>A Finite Element Method for Large Domains</strong> , Computer Methods in Applied Mechanics and Engineering , 76(1) (1989), 41-66.
</a></p>

<p><a id="ref-6"> 
[6] J.B. Keller and D. Givoli, <strong>Exact Non-Reflecting Boundary-Conditions</strong> , Journal of Computational Physics , 82(1) (1989), 172-192.
</a></p>

<p><a id="ref-7"> 
[7] D. Givoli, <strong>Numerical Methods for Problems in Infinite Domains</strong>, 1992, Elsevier Science.
</a></p>

<p><a id="ref-8"> 
[8] M. Grote and J. Keller, <strong>Exact Nonreflecting Boundary Conditions for the Time Dependent Wave Equation</strong> , SIAM Journal on Applied Mathematics , 55(2) (1995), 280-297.
</a></p>

<p><a id="ref-9"> 
[9] I. Patlashenko, D. Givoli and P. Barbone, <strong>Time-Stepping Schemes for Systems of Volterra Integro-Differential Equations</strong> , Computer Methods in Applied Mechanics and Engineering , 190 (2001), 5691-5718.
</a></p>

<p><a id="ref-10"> 
[10] T.J.R. Hughes and M. Mallet, <strong>A New Finite Element Formulation for Computational Fluid Dynamics: III. The Generalized Streamline Operator for Advective-Diffusive Systems</strong> , Computer Methods in Applied Mechanics and Engineering , 58 (1986), 305-328.
</a></p>

<p><a id="ref-11"> 
[11] T.J.R. Hughes, L.P. Franca and G.M. Hulbert, <strong>A New Finite Element Formulation for Computational Fluid Dynamics: VIII. The Galerkin/Least-Squares Method for Advective-Diffusive Equations</strong> , Computer Methods in Applied Mechanics and Engineering , 73(2) (1989), 173-189.
</a></p>
</section>


</div>





    </div>
</div>


    <!-- /.container -->
    <nav class="navbar navbar-default navbar-fixed-bottom">
        <div class="container-fluid text-center">
          <ul class="nav navbar-nav">
            <li><a>Copyright &copy; SimVascular Development Team - 2017</a></li>
          </ul>
        </div>
        <!-- /.container -->
    </nav>


    <script src="js/jquery-1.11.0.js" type="text/javascript"></script><script src="js/bootstrap.min.js" type="text/javascript"></script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
      });
      $('body').scrollspy({
        target: '.bs-docs-sidebar',
        offset: 40
      });
    </script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-55333921-1', 'auto');
      ga('send', 'pageview');
    </script>

    <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

</body>

</html>
